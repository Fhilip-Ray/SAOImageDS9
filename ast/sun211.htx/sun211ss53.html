<!DOCTYPE html> 
<html> 
<head><title> astFitsChan </title> 
<meta charset=utf-8/> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<link rel="stylesheet" type="text/css" href="sun211.css" /> 
 <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML"></script><style type="text/css">.MathJax_MathML {text-indent: 0;}</style></head><body 
>
<div class="sstrefsection"><div class="crosslinks"><ul class='nav'> <li class="prev"> <a 
href="sun211ss52.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for Handling<BR>World Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211ss54.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li>
</ul></div>
<!--l. 15577--><p class="noindent" ><header class="sstreftitle"><h3 class="sstsectitle"><a 
 id="x78-2700000"></a> astFitsChan </h3>  <p class="subtitle"> Create a FitsChan  </p> </h3> </header><a 
 id="Q1-78-392"></a> <a 
 id="Q1-78-393"></a> <a name="xref_astFitsChan"></a>  <h4 class="ssth4">Description: </h4><div class="sstvalues"> This function creates a new
<a 
href="sun211ss449.html#x476-6680000">FitsChan</a> and optionally initialises its attributes.
<!--l. 15577--><p class="noindent" >A FitsChan is a specialised form of <a 
href="sun211ss441.html#x468-6600000">Channel</a> which supports I/O operations involving the
use of FITS (Flexible Image Transport <a 
href="sun211ss413.html#x439-6310000">System</a>) header cards. Writing an <a 
href="sun211ss464.html#x491-6830000">Object</a> to a
FitsChan (using <a 
href="sun211ss237.html#x262-4540000">astWrite</a>) will, if the Object is suitable, generate a description of
that Object composed of FITS header cards, and reading from a FitsChan will create a
new Object from its FITS header card description.
<!--l. 15577--><p class="noindent" >While a FitsChan is active, it represents a buffer which may contain zero or more
80-character <code>&#x0022;</code> header cards<code>&#x0022;</code> conforming to FITS conventions. Any sequence of
FITS-conforming header cards may be stored, apart from the <code>&#x0022;</code> END<code>&#x0022;</code> card whose
existence is merely implied. The cards may be accessed in any order by using the
FitsChan<code>&#x2019;</code> s integer <a 
href="sun211ss258.html#x284-4760000">Card</a> attribute, which identifies a <code>&#x0022;</code> current<code>&#x0022;</code> card, to
which subsequent operations apply. Searches based on keyword may be performed
(using <a 
href="sun211ss51.html#x76-2680000">astFindFits</a>), new cards may be inserted (<a 
href="sun211ss153.html#x178-3700000">astPutFits</a>, <a 
href="sun211ss150.html#x175-3670000">astPutCards</a>,
<a 
href="sun211ss180.html#x205-3970000">astSetFits<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>X<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math></a>)
and existing ones may be deleted (<a 
href="sun211ss39.html#x64-2560000">astDelFits</a>) or changed
(astSetFits<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>X<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>).
<!--l. 15577--><p class="noindent" >When you create a FitsChan, you have the option of specifying <code>&#x0022;</code> source<code>&#x0022;</code> and <code>&#x0022;</code>
sink<code>&#x0022;</code> functions which connect it to external data stores by reading and writing
FITS header cards. If you provide a source function, it is used to fill the
FitsChan with header cards when it is accessed for the first time. If you do not
provide a source function, the FitsChan remains empty until you explicitly enter
data into it (e.g. using astPutFits, astPutCards, astWrite or by using the
<a 
href="sun211ss399.html#x425-6170000">SourceFile</a> attribute to specifying a text file from which headers should be
read). When the FitsChan is deleted, any remaining header cards in the FitsChan
can be saved in either of two ways: 1) by specifying a value for the <a 
href="sun211ss390.html#x416-6080000">SinkFile</a>
attribute (the name of a text file to which header cards should be written), or 2)
by providing a sink function (used to to deliver header cards to an external
data store). If you do not provide a sink function or a value for SinkFile,
any header cards remaining when the FitsChan is deleted will be lost, so you
should arrange to extract them first if necessary (e.g. using astFindFits or
<a 
href="sun211ss160.html#x185-3770000">astRead</a>).
<!--l. 15577--><p class="noindent" >Coordinate system information may be described using FITS header cards using
                                                                                       

                                                                                       
several different conventions, termed <code>&#x0022;</code> encodings<code>&#x0022;</code> . When an AST Object is
written to (or read from) a FitsChan, the value of the FitsChan<code>&#x2019;</code> s <a 
href="sun211ss284.html#x310-5020000">Encoding</a>
attribute determines how the Object is converted to (or from) a description
involving FITS header cards. In general, different encodings will result in
different sets of header cards to describe the same Object. Examples of encodings
include the DSS encoding (based on conventions used by the STScI Digitised
Sky Survey data), the FITS-WCS encoding (based on a proposed FITS standard)
and the NATIVE encoding (a near loss-less way of storing AST Objects in FITS
headers).
<!--l. 15577--><p class="noindent" >The available encodings differ in the range of Objects they can represent,
in the number of Object descriptions that can coexist in the same FitsChan,
and in their accessibility to other (external) astronomy applications (see
the Encoding attribute for details). Encodings are not necessarily mutually
exclusive and it may sometimes be possible to describe the same Object in several
ways within a particular set of FITS header cards by using several different
encodings.
<!--l. 15577--><p class="noindent" >The detailed behaviour of astRead and astWrite, when used with a FitsChan, depends on
the encoding in use. In general, however, all use of astRead is destructive, so that
FITS header cards are consumed in the process of reading an Object, and are removed
from the FitsChan (this deletion can be prevented for specific cards by calling the
<a 
href="sun211ss174.html#x199-3910000">astRetainFits</a> function).
<!--l. 15577--><p class="noindent" >If the encoding in use allows only a single Object description to be stored in a
FitsChan (e.g. the DSS, FITS-WCS and FITS-IRAF encodings), then write operations using
astWrite will over-write any existing Object description using that encoding.
Otherwise (e.g. the NATIVE encoding), multiple Object descriptions are written
sequentially and may later be read back in the same sequence.  </div> <h4 class="ssth4">Synopsis </h4><div class="sstvalues"> AstFitsChan
<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2217;</mo></math>astFitsChan( const char
<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2217;</mo></math>(<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2217;</mo></math>
source)( void ), void (<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2217;</mo></math>
sink)( const char <!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2217;</mo></math> ),
const char <!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2217;</mo></math>options,
... )  </div> <h4 class="ssth4">Parameters: </h4><div class="sstvalues"> <h5 class="ssth5"> source  </h5><div class="sstsub"> Pointer to a source function which takes no arguments
and returns a pointer to a null-terminated string. This function will be used by the
FitsChan to obtain input FITS header cards. On each invocation, it should read the next
input card from some external source (such as a FITS file), and return a pointer to the
(null-terminated) contents of the card. It should return a NULL pointer when there are
no more cards to be read.
<!--l. 15577--><p class="noindent" >If <code>&#x0022;</code> source<code>&#x0022;</code> is NULL, the FitsChan will remain empty until cards are explicitly stored
in it (e.g. using astPutCards, astPutFits or via the SourceFile attribute).  </div> <h5 class="ssth5"> sink  </h5><div class="sstsub">
Pointer to a sink function that takes a pointer to a null-terminated string as an
argument and returns void. If no value has been set for the SinkFile attribute, this
function will be used by the FitsChan to deliver any FITS header cards it contains when
it is finally deleted. On each invocation, it should deliver the contents of the
character string passed to it as a FITS header card to some external data store (such
as a FITS file).
<!--l. 15577--><p class="noindent" >If <code>&#x0022;</code> sink<code>&#x0022;</code> is NULL, and no value has been set for the SinkFile attribute, the contents
                                                                                       

                                                                                       
of the FitsChan will be lost when it is deleted.  </div> <h5 class="ssth5"> options  </h5><div class="sstsub"> Pointer to a
null-terminated string containing an optional comma-separated list of attribute
assignments to be used for initialising the new FitsChan. The syntax used is identical
to that for the <a 
href="sun211ss177.html#x202-3940000">astSet</a> function and may include <code>&#x0022;</code> printf<code>&#x0022;</code> format specifiers identified
by <code>&#x0022;</code> %<code>&#x0022;</code> symbols in the normal way.  </div> <h5 class="ssth5"> ...  </h5><div class="sstsub"> If the <code>&#x0022;</code> options<code>&#x0022;</code> string contains <code>&#x0022;</code> %<code>&#x0022;</code>
format specifiers, then an optional list of additional arguments may follow it in order
to supply values to be substituted for these specifiers. The rules for supplying
these are identical to those for the astSet function (and for the C <code>&#x0022;</code> printf<code>&#x0022;</code>
function).
<!--l. 15577--><p class="noindent" >Note, the FITSCHAN_OPTIONS environment variable may be used to specify default options
for all newly created FitsChans.  </div>  </div> <h4 class="ssth4">Returned Value </h4><div class="sstvalues"> <h5 class="ssth5"> astFitsChan()  </h5><div class="sstsub"> A pointer to the
new FitsChan.  </div>  </div> <h4 class="ssth4">Notes: </h4><div class="sstvalues"> <ul class="sstitemlist">
<li >
<!--l. 15577--><p class="noindent" >No FITS <code>&#x0022;</code> END<code>&#x0022;</code> card will be written via the sink function. You should add this card
yourself after the FitsChan has been deleted.
<li >
<!--l. 15577--><p class="noindent" >A null Object pointer (AST__NULL) will be returned if this function is invoked
with the AST error status set, or if it should fail for any reason.  </li></ul>  </div>
<h4 class="ssth4"> Status Handling  </h4><div class="sstvalues"> The protected interface to this function includes an
extra parameter at the end of the parameter list descirbed above. This
parameter is a pointer to the integer inherited status variable: <code>&#x0022;</code> int
<!--l. 15577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2217;</mo></math>status<code>&#x0022;</code> .
</div><div class="crosslinks"> <div class="copyright"><span class="pushright">Copyright (C) 2014 Science &#x0026; Technology Facilities Council</span></div> <ul class='nav'> <li class="prev"> <a 
href="sun211ss52.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for
Handling<BR>World Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211ss54.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li> </ul></div>
<!--l. 33670--><p class="noindent" ><a 
 id="tailsun211ss53.html"></a> </div> 
</body> 
</html>