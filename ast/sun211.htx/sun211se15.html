<!DOCTYPE html> 
<html> 
<head><title>Saving and Restoring Objects (Channels)</title> 
<meta charset=utf-8/> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<link rel="stylesheet" type="text/css" href="sun211.css" /> 
 <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML"></script><style type="text/css">.MathJax_MathML {text-indent: 0;}</style></head><body 
>
<div class="crosslinks"><ul class='nav'> <li class="prev"> <a 
href="sun211se14.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for Handling<BR>World Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211se16.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li>
</ul></div>
<h3 class="sectionHead"><span class="titlemark">15    </span> <a 
 id="x16-14100015"></a>Saving and Restoring Objects (Channels)</h3>
<div class="sectionTOCS">
&#x00A0;<span class="subsectionToc" >15.1 <a 
href="#x16-1420001">The Channel Model</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.2 <a 
href="#x16-1430002">Creating a Channel</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.3 <a 
href="#x16-1440003">Writing Objects to a Channel</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.4 <a 
href="#x16-1450004">Reading Objects from a Channel</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.5 <a 
href="#x16-1460005">Saving and Restoring Multiple Objects</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.6 <a 
href="#x16-1470006">Validating Input</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.7 <a 
href="#x16-1480007">Storing an ID String with an Object</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.8 <a 
href="#x16-1490008">The Textual Output Format</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.9 <a 
href="#x16-1500009">Controlling the Amount of Output</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.10 <a 
href="#x16-15100010">Controlling Commenting</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.11 <a 
href="#x16-15200011">Editing Textual Output</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.12 <a 
href="#x16-15300012">Mixing Objects with other Text</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.13 <a 
href="#x16-15400013">Reading Objects from Files</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.14 <a 
href="#x16-15500014">Writing Objects to Files</a></span>
<br />&#x00A0;<span class="subsectionToc" >15.15 <a 
href="#x16-15600015">Reading and Writing Objects to other Places</a></span>
</div>
<!--l. 7538--><p class="noindent" >Facilities are provided by the AST library for performing input and output (I/O) with any kind of
<a 
href="sun211ss464.html#x491-6830000">Object</a>. This means it is possible to write any Object into various external representations for storage,
and then to read these representations back in, so as to restore the original Object. Typically, an Object
would be written by one program and read back in by another.
                                                                                       

                                                                                       
<!--l. 7545--><p class="noindent" >We refer to &#x201C;external representations&#x201D; in the plural because AST is designed to function
independently of any particular data storage system. This means that Objects may need converting
into a number of different external representations in order to be compatible with (say) the
astronomical data storage system in which they will reside.
<!--l. 7551--><p class="noindent" >In this section, we discuss the basic I/O facilities which support external representations based on a
textual format referred to as the AST &#x201C;native format&#x201D;. These are implemented using a new kind of
Object&#x2014;a <a 
href="sun211ss441.html#x468-6600000">Channel</a>. We will examine later how to use other representations, based on an XML format
or on the use of FITS headers, for storing Objects. These are implemented using more specialised
forms of Channel called <a 
href="sun211ss499.html#x526-7180000">XmlChan</a> (&#x00A7;<a 
href="sun211se18.html#x19-18000018">18<!--tex4ht:ref: ss:xmlchan --></a>) and <a 
href="sun211ss449.html#x476-6680000">FitsChan</a> (&#x00A7;<a 
href="sun211se16.html#x17-15700016">16<!--tex4ht:ref: ss:nativefits --></a>).
<a 
 id="x16-141001r156"></a>
<h4 class="subsectionHead"><span class="titlemark">15.1    </span> <a 
 id="x16-1420001"></a>The Channel Model</h4>
<!--l. 7561--><p class="noindent" >The best way to start thinking about a <a 
href="sun211ss441.html#x468-6600000">Channel</a> is like a C file stream, and to think of the process of
creating a Channel as that of opening a file and obtaining a FILE pointer. Subsequently, you can read
and write Objects <em>via</em> the Channel.
<!--l. 7566--><p class="noindent" >This analogy is not quite perfect, however, because a Channel has, in principle, two &#x201C;files&#x201D; attached to
it. One is used when reading, and the other when writing. These are termed the Channel&#x2019;s <em>source</em> and
<em>sink</em> respectively. In practice, the source and sink may both be the same, in which case the analogy
with the C file stream is correct, but this need not always be so. It is not necessarily so with the basic
Channel, as we will now see (&#x00A7;<a 
href="#x16-1430002">15.2<!--tex4ht:ref: ss:creatingachannel --></a>).
<a 
 id="x16-142001r159"></a>
<h4 class="subsectionHead"><span class="titlemark">15.2    </span> <a 
 id="x16-1430002"></a>Creating a Channel</h4>
<!--l. 7576--><p class="noindent" >The process of creating a <a 
href="sun211ss441.html#x468-6600000">Channel</a> is straightforward. As you might expect, it uses the constructor
function <a 
href="sun211ss17.html#x42-2340000">astChannel</a>:
<div class="fancyvrb" id="fancyvrb165"> <a 
 id="x16-143002r1"></a>&#x00A0;&#x00A0;#include&#x00A0;&#x0022;ast.h&#x0022;<br class="fancyvrb" /><a 
 id="x16-143004r2"></a>&#x00A0;&#x00A0;AstChannel&#x00A0;*channel;<br class="fancyvrb" /><a 
 id="x16-143006r3"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-143008r4"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x16-143010r5"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-143012r6"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astChannel(&#x00A0;NULL,&#x00A0;NULL,&#x00A0;&#x0022;&#x0022;&#x00A0;);</div>
<!--l. 7590--><p class="noindent" >The first two arguments to astChannel specify the external source and sink that the Channel is to use.
There arguments are pointers to C functions and we will examine their use in more detail later (&#x00A7;<a 
href="#x16-15400013">15.13<!--tex4ht:ref: ss:channelsource --></a>
and &#x00A7;<a 
href="#x16-15500014">15.14<!--tex4ht:ref: ss:channelsink --></a>).
<!--l. 7595--><p class="noindent" >In this very simple example we have supplied NULL pointers for both the source and sink functions.
This requests the default behaviour, which means that textual input will be read from the program&#x2019;s
standard input stream (typically, this means your keyboard) while textual output will go to the
standard output stream (typically appearing on your screen). On UNIX systems, of course, either of
these streams can easily be redirected to files. This default behaviour can be changed by
assigning values to the Channel&#x2019;s <a 
href="sun211ss390.html#x416-6080000">SinkFile</a> and/or <a 
href="sun211ss399.html#x425-6170000">SourceFile</a> attributes. These attributes
specify the paths to text files that are to be used in place of the standard input and output
streams.
<a 
 id="x16-143013r160"></a>
<h4 class="subsectionHead"><span class="titlemark">15.3    </span> <a 
 id="x16-1440003"></a>Writing Objects to a Channel</h4>
<!--l. 7608--><p class="noindent" >The process of saving Objects is very straightforward. You can simply write any <a 
href="sun211ss464.html#x491-6830000">Object</a> to a <a 
href="sun211ss441.html#x468-6600000">Channel</a>
using the <a 
href="sun211ss237.html#x262-4540000">astWrite</a> function, as follows:
<div class="fancyvrb" id="fancyvrb166"> <a 
 id="x16-144002r1"></a>&#x00A0;&#x00A0;int&#x00A0;nobj;<br class="fancyvrb" /><a 
 id="x16-144004r2"></a>&#x00A0;&#x00A0;AstObject&#x00A0;*object;<br class="fancyvrb" /><a 
 id="x16-144006r3"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-144008r4"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x16-144010r5"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-144012r6"></a>&#x00A0;&#x00A0;nobj&#x00A0;=&#x00A0;astWrite(&#x00A0;channel,&#x00A0;object&#x00A0;);</div>
                                                                                       

                                                                                       
<!--l. 7623--><p class="noindent" >The effect of this will be to produce a textual description of the Object which will appear, by default,
on your program&#x2019;s standard output stream. Any class of Object may be converted into text in this
way.
<!--l. 7628--><p class="noindent" >astWrite returns a count of the number of Objects written. Usually, this will be one, unless the Object
supplied cannot be represented. With a basic Channel all Objects can be represented, so a value of one
will always be returned unless there has been an error. We will see later, however, that
more specialised forms of Channel may impose restrictions on the kind of Object you can
write (&#x00A7;<a 
href="sun211se17.html#x18-1740002">17.2<!--tex4ht:ref: ss:foreignfitslimitations --></a>). In such cases, astWrite may return zero to indicate that the Object was not
acceptable.
<a 
 id="x16-144013r161"></a>
<h4 class="subsectionHead"><span class="titlemark">15.4    </span> <a 
 id="x16-1450004"></a>Reading Objects from a Channel</h4>
<!--l. 7639--><p class="noindent" >Before discussing the format of the output produced above (&#x00A7;<a 
href="#x16-1440003">15.3<!--tex4ht:ref: ss:writingtoachannel --></a>), let us consider how to read it back,
so as to reconstruct the original <a 
href="sun211ss464.html#x491-6830000">Object</a>. Naturally, we would first need to save the output in a file. We
can do that either by using the <a 
href="sun211ss390.html#x416-6080000">SinkFile</a> attribute, or (on UNIX systems), by redirecting standard
output to a file using a shell command like:
<div class="fancyvrb" id="fancyvrb167"> <a 
 id="x16-145002r1"></a>&#x00A0;&#x00A0;program1&#x00A0;&#x003E;file</div>
<!--l. 7652--><p class="noindent" >Within a subsequent program, we can read this Object back in by using the <a 
href="sun211ss160.html#x185-3770000">astRead</a> function, having
first created a suitable <a 
href="sun211ss441.html#x468-6600000">Channel</a>:
<div class="fancyvrb" id="fancyvrb168"> <a 
 id="x16-145004r1"></a>&#x00A0;&#x00A0;object&#x00A0;=&#x00A0;astRead(&#x00A0;channel&#x00A0;);</div>
<!--l. 7662--><p class="noindent" >By default, this function will read from the standard input stream (the default source for a basic
Channel), so we would need to ensure that our second program reads its input from the file in which
the Object description is stored. On UNIX systems, we could again use a shell redirection command
such as:
<div class="fancyvrb" id="fancyvrb169"> <a 
 id="x16-145006r1"></a>&#x00A0;&#x00A0;program2&#x00A0;&#x003C;file</div>
<!--l. 7674--><p class="noindent" >Alternatively, we could have assigned a value to the SinkFile attribute before invoking
astRead.
<a 
 id="x16-145007r162"></a>
<h4 class="subsectionHead"><span class="titlemark">15.5    </span> <a 
 id="x16-1460005"></a>Saving and Restoring Multiple Objects</h4>
<!--l. 7680--><p class="noindent" >I/O operations performed on a basic <a 
href="sun211ss441.html#x468-6600000">Channel</a> are sequential. This means that if you write more than
one <a 
href="sun211ss464.html#x491-6830000">Object</a> to a Channel, each new Object&#x2019;s textual description is simply appended to the previous
one. You can store any number of Objects in this way, subject only to the storage space you have
available.
<!--l. 7686--><p class="noindent" >After you read an Object back from a basic Channel, the Channel is &#x201C;positioned&#x201D; at the end of that
Object&#x2019;s textual description. If you then perform another read, you will read the next Object&#x2019;s textual
description and therefore retrieve the next Object. This process may be repeated to read each Object in
turn. When there are no more Objects to be read, <a 
href="sun211ss160.html#x185-3770000">astRead</a> will return the value AST__NULL to
indicate an <em>end-of-file</em>.
                                                                                       

                                                                                       
<a 
 id="x16-146001r163"></a>
<h4 class="subsectionHead"><span class="titlemark">15.6    </span> <a 
 id="x16-1470006"></a>Validating Input</h4>
<!--l. 7697--><p class="noindent" >The pointer returned by <a 
href="sun211ss160.html#x185-3770000">astRead</a> (&#x00A7;<a 
href="#x16-1450004">15.4<!--tex4ht:ref: ss:readingfromachannel --></a>) could identify any class of <a 
href="sun211ss464.html#x491-6830000">Object</a>&#x2014;this is
determined entirely by the external data being read. If it is necessary to test for a particular
class (say a <a 
href="sun211ss452.html#x479-6710000">Frame</a>), this may be done as follows using the appropriate member of the
<a 
href="sun211ss95.html#x120-3120000">astIsA<!--l. 7701--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo></math>Class<!--l. 7701--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math></a>
family of functions:
<div class="fancyvrb" id="fancyvrb170"> <a 
 id="x16-147002r1"></a>&#x00A0;&#x00A0;int&#x00A0;ok;<br class="fancyvrb" /><a 
 id="x16-147004r2"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-147006r3"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x16-147008r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-147010r5"></a>&#x00A0;&#x00A0;ok&#x00A0;=&#x00A0;astIsAFrame(&#x00A0;object&#x00A0;);</div>
<!--l. 7713--><p class="noindent" >Note, however, that this will accept any Frame, so would be equally happy with a basic Frame or a
<a 
href="sun211ss478.html#x505-6970000">SkyFrame</a>. An alternative validation strategy would be to obtain the value of the Object&#x2019;s <a 
href="sun211ss262.html#x288-4800000">Class</a>
attribute and then test this character string, as follows:
<div class="fancyvrb" id="fancyvrb171"> <a 
 id="x16-147012r1"></a>&#x00A0;&#x00A0;#include&#x00A0;&#x003C;string.h&#x003E;<br class="fancyvrb" /><a 
 id="x16-147014r2"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-147016r3"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x16-147018r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-147020r5"></a>&#x00A0;&#x00A0;ok&#x00A0;=&#x00A0;!strcmp(&#x00A0;astGetC(&#x00A0;object,&#x00A0;&#x0022;Class&#x0022;&#x00A0;),&#x00A0;&#x0022;Frame&#x0022;&#x00A0;);</div>
<!--l. 7728--><p class="noindent" >This would only accept a basic Frame and would reject a SkyFrame.
<a 
 id="x16-147021r164"></a>
<h4 class="subsectionHead"><span class="titlemark">15.7    </span> <a 
 id="x16-1480007"></a>Storing an ID String with an Object</h4>
<!--l. 7732--><p class="noindent" >Occasionally, you may want to store a number of Objects and later retrieve them and use each for a
different purpose. If the Objects are of the same class, you cannot use the <a 
href="sun211ss262.html#x288-4800000">Class</a> attribute to distinguish
them when you read them back (<em>c.f.</em>&#x00A0;&#x00A7;<a 
href="#x16-1470006">15.6<!--tex4ht:ref: ss:validatinginput --></a>). Although relying on the order in which they are
stored is a possible solution, this becomes complicated if some of the Objects are optional
and may not always be present. It also makes extending your data format in future more
difficult.
<!--l. 7742--><p class="noindent" >To help with this, every AST <a 
href="sun211ss464.html#x491-6830000">Object</a> has an <a 
href="sun211ss305.html#x331-5230000">ID</a> attribute and an <a 
href="sun211ss307.html#x333-5250000">Ident</a> attribute, both of which allows
you, in effect, to attach a textual identification label to it. You simply set the ID or Ident attribute
before writing the Object:
<div class="fancyvrb" id="fancyvrb172"> <a 
 id="x16-148002r1"></a>&#x00A0;&#x00A0;astSet(&#x00A0;object,&#x00A0;&#x0022;ID=Calibration&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-148004r2"></a>&#x00A0;&#x00A0;nobj&#x00A0;=&#x00A0;astWrite(&#x00A0;channel,&#x00A0;object&#x00A0;);</div>
<!--l. 7754--><p class="noindent" >You can then test its value after you read the Object back:
<div class="fancyvrb" id="fancyvrb173"> <a 
 id="x16-148006r1"></a>&#x00A0;&#x00A0;object&#x00A0;=&#x00A0;astRead(&#x00A0;channel&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-148008r2"></a>&#x00A0;&#x00A0;if&#x00A0;(&#x00A0;!strcmp(&#x00A0;astGetC(&#x00A0;object,&#x00A0;&#x0022;ID&#x0022;&#x00A0;),&#x00A0;&#x0022;Calibration&#x0022;&#x00A0;)&#x00A0;)&#x00A0;{
<br class="fancyvrb" /><a 
 id="x16-148010r3"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;the&#x00A0;Calibration&#x00A0;Object&#x00A0;has&#x00A0;been&#x00A0;read&#x003E;<br class="fancyvrb" /><a 
 id="x16-148012r4"></a>&#x00A0;&#x00A0;}&#x00A0;else&#x00A0;{<br class="fancyvrb" /><a 
 id="x16-148014r5"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;some&#x00A0;other&#x00A0;Object&#x00A0;has&#x00A0;been&#x00A0;read&#x003E;<br class="fancyvrb" /><a 
 id="x16-148016r6"></a>&#x00A0;&#x00A0;}</div>
<!--l. 7767--><p class="noindent" >The only difference between the ID and Ident attributes is that the ID attribute is unique to a particular
Object and is lost if, for example, you make a copy of the Object. The Ident attrubute, on the other
hand, is transferred to the new Object when a copy is made. Consequently, it is safest to set the value
of the ID attribute immediately before you perform the write.
<a 
 id="x16-148017r165"></a>
                                                                                       

                                                                                       
<h4 class="subsectionHead"><span class="titlemark">15.8    </span> <a 
 id="x16-1490008"></a>The Textual Output Format</h4>
<!--l. 7776--><p class="noindent" >Let us now examine the format of the textual output produced by writing an <a 
href="sun211ss464.html#x491-6830000">Object</a> to a basic <a 
href="sun211ss441.html#x468-6600000">Channel</a>
(&#x00A7;<a 
href="#x16-1440003">15.3<!--tex4ht:ref: ss:writingtoachannel --></a>). To give a concrete example, suppose the Object in question is a <a 
href="sun211ss478.html#x505-6970000">SkyFrame</a>, written out as
follows:
<div class="fancyvrb" id="fancyvrb174"> <a 
 id="x16-149002r1"></a>&#x00A0;&#x00A0;AstSkyFrame&#x00A0;*skyframe;<br class="fancyvrb" /><a 
 id="x16-149004r2"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-149006r3"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x16-149008r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-149010r5"></a>&#x00A0;&#x00A0;nobj&#x00A0;=&#x00A0;astWrite(&#x00A0;channel,&#x00A0;skyframe&#x00A0;);</div>
<!--l. 7791--><p class="noindent" >The output should then look like the following:
<div class="fancyvrb" id="fancyvrb175"> <a 
 id="x16-149012r1"></a>&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyFrame&#x00A0;        #&#x00A0;Description&#x00A0;of&#x00A0;celestial&#x00A0;coordinate&#x00A0;system
<br class="fancyvrb" /><a 
 id="x16-149014r2"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Title&#x00A0;=&#x00A0;&#x0022;FK4&#x00A0;Equatorial&#x00A0;Coordinates,&#x00A0;no&#x00A0;E-terms,&#x00A0;Mean&#x00A0;Equinox&#x00A0;B1950.0,&#x00A0;Epoch&#x00A0;B1958.0&#x0022;&#x00A0;        #&#x00A0;Title&#x00A0;of&#x00A0;coordinate&#x00A0;system
<br class="fancyvrb" /><a 
 id="x16-149016r3"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Naxes&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Number&#x00A0;of&#x00A0;coordinate&#x00A0;axes<br class="fancyvrb" /><a 
 id="x16-149018r4"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Domain&#x00A0;=&#x00A0;&#x0022;SKY&#x0022;&#x00A0;        #&#x00A0;Coordinate&#x00A0;system&#x00A0;domain
<br class="fancyvrb" /><a 
 id="x16-149020r5"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Lbl1&#x00A0;=&#x00A0;&#x0022;Right&#x00A0;Ascension&#x0022;&#x00A0;        #&#x00A0;Label&#x00A0;for&#x00A0;axis&#x00A0;1<br class="fancyvrb" /><a 
 id="x16-149022r6"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Lbl2&#x00A0;=&#x00A0;&#x0022;Declination&#x0022;&#x00A0;        #&#x00A0;Label&#x00A0;for&#x00A0;axis&#x00A0;2
<br class="fancyvrb" /><a 
 id="x16-149024r7"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Uni1&#x00A0;=&#x00A0;&#x0022;hh:mm:ss.s&#x0022;&#x00A0;        #&#x00A0;Units&#x00A0;for&#x00A0;axis&#x00A0;1<br class="fancyvrb" /><a 
 id="x16-149026r8"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Uni2&#x00A0;=&#x00A0;&#x0022;ddd:mm:ss&#x0022;&#x00A0;        #&#x00A0;Units&#x00A0;for&#x00A0;axis&#x00A0;2
<br class="fancyvrb" /><a 
 id="x16-149028r9"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Dir1&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Plot&#x00A0;axis&#x00A0;1&#x00A0;in&#x00A0;reverse&#x00A0;direction&#x00A0;(hint)<br class="fancyvrb" /><a 
 id="x16-149030r10"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax1&#x00A0;=&#x00A0;        #&#x00A0;Axis&#x00A0;number&#x00A0;1
<br class="fancyvrb" /><a 
 id="x16-149032r11"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;axis<br class="fancyvrb" /><a 
 id="x16-149034r12"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis
<br class="fancyvrb" /><a 
 id="x16-149036r13"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax2&#x00A0;=&#x00A0;        #&#x00A0;Axis&#x00A0;number&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-149038r14"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;axis
<br class="fancyvrb" /><a 
 id="x16-149040r15"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis<br class="fancyvrb" /><a 
 id="x16-149042r16"></a>&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Frame&#x00A0;        #&#x00A0;Coordinate&#x00A0;system&#x00A0;description
<br class="fancyvrb" /><a 
 id="x16-149044r17"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System&#x00A0;=&#x00A0;&#x0022;FK4-NO-E&#x0022;&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;system&#x00A0;type
<br class="fancyvrb" /><a 
 id="x16-149046r18"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Epoch&#x00A0;=&#x00A0;1958&#x00A0;        #&#x00A0;Besselian&#x00A0;epoch&#x00A0;of&#x00A0;observation
<br class="fancyvrb" /><a 
 id="x16-149048r19"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Eqnox&#x00A0;=&#x00A0;1950&#x00A0;        #&#x00A0;Besselian&#x00A0;epoch&#x00A0;of&#x00A0;mean&#x00A0;equinox<br class="fancyvrb" /><a 
 id="x16-149050r20"></a>&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyFrame</div>
<!--l. 7818--><p class="noindent" >You will notice that this output is designed both for a human reader, in that it is formatted, and also to
be read back by a computer in order to reconstruct the SkyFrame. In fact, this is precisely the way that
<a 
href="sun211ss187.html#x212-4040000">astShow</a> works (&#x00A7;<a 
href="sun211se4.html#x5-380004">4.4<!--tex4ht:ref: ss:displayingobjects --></a>), this function being roughly equivalent to the following use of a
Channel:
<div class="fancyvrb" id="fancyvrb176"> <a 
 id="x16-149052r1"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astChannel(&#x00A0;NULL,&#x00A0;NULL,&#x00A0;&#x0022;&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-149054r2"></a>&#x00A0;&#x00A0;(void)&#x00A0;astWrite(&#x00A0;channel,&#x00A0;object&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-149056r3"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astAnnul(&#x00A0;channel&#x00A0;);</div>
<!--l. 7832--><p class="noindent" >Some lines of the output start with a &#x201C;<span class="obeylines-h"><span class="verb">#</span></span>&#x201D; comment character, which turns the rest of the line into a
comment. These lines will be ignored when read back in by <a 
href="sun211ss160.html#x185-3770000">astRead</a>. They typically contain default
values, or values that can be derived in some way from the other data present, so that they do not
actually need to be stored in order to reconstruct the original Object. They are provided purely for
human information. The same comment character is also used to append explanatory comments to
most output lines.
<!--l. 7841--><p class="noindent" >It is not sensible to attempt a complete description of this output format because every class of Object
is potentially different and each can define how its own data should be represented. However,
there are some basic rules, which mean that the following common features will usually be
present:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  (1) </dt><dd 
class="enumerate-enumitem">Each Object is delimited by matching &#x201C;Begin&#x201D; and &#x201C;End&#x201D; lines, which also identify the
     class of Object involved.
                                                                                       

                                                                                       
     </dd><dt class="enumerate-enumitem">
  (2) </dt><dd 
class="enumerate-enumitem">Within each Object description, data values are represented by a simple &#x201C;keyword&#x00A0;<!--l. 7852--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">=</mo></math>&#x00A0;value&#x201D;
     syntax, with one value to a line.
     </dd><dt class="enumerate-enumitem">
  (3) </dt><dd 
class="enumerate-enumitem">Lines beginning &#x201C;IsA&#x201D; are used to mark the divisions between data belonging to different
     levels in the class hierarchy (Appendix&#x00A0;<a 
href="sun211se23.html#x24-2160001">A<!--tex4ht:ref: ss:classhierarchy --></a>). Thus, &#x201C;IsA&#x00A0;<a 
href="sun211ss452.html#x479-6710000">Frame</a>&#x201D; marks the end of data
     associated with the Frame class and the start of data associated with some derived class
     (a SkyFrame in the above example). &#x201C;IsA&#x201D; lines may be omitted if associated data values
     are absent and no confusion arises.
     </dd><dt class="enumerate-enumitem">
  (4) </dt><dd 
class="enumerate-enumitem">Objects may contain other Objects as data. This is indicated by an absent value, with the
     description of the data Object following on subsequent lines.
     </dd><dt class="enumerate-enumitem">
  (5) </dt><dd 
class="enumerate-enumitem">Indentation is used to clarify the overall structure.</dd></dl>
<!--l. 7869--><p class="noindent" >Beyond these general principles, the best guide to what a particular line of output represents will
generally be the comment which accompanies it together with a general knowledge of the class of
Object being described.
<a 
 id="x16-149062r166"></a>
<h4 class="subsectionHead"><span class="titlemark">15.9    </span> <a 
 id="x16-1500009"></a>Controlling the Amount of Output</h4>
<!--l. 7876--><p class="noindent" >It is not always necessary for the output from <a 
href="sun211ss237.html#x262-4540000">astWrite</a> (&#x00A7;<a 
href="#x16-1440003">15.3<!--tex4ht:ref: ss:writingtoachannel --></a>) to be human-readable, so a <a 
href="sun211ss441.html#x468-6600000">Channel</a> has
attributes that allow the amount of detail in the output to be controlled.
<!--l. 7881--><p class="noindent" >The first of these is the integer attribute <a 
href="sun211ss293.html#x319-5110000">Full</a>, which controls the extent to which
optional, commented out, output lines are produced. By default, Full is zero, and
this results in the standard style of output (&#x00A7;<a 
href="#x16-1490008">15.8<!--tex4ht:ref: ss:textualoutputformat --></a>) where default values that may be
helpful to humans are included. To suppress these optional lines, Full should be set to
<!--l. 7886--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">&#x2212;</mo></math>1. This
is most conveniently done when the Channel is created, so that:
<div class="fancyvrb" id="fancyvrb177"> <a 
 id="x16-150002r1"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astChannel(&#x00A0;NULL,&#x00A0;NULL,&#x00A0;&#x0022;Full=-1&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-150004r2"></a>&#x00A0;&#x00A0;(void)&#x00A0;astWrite(&#x00A0;channel,&#x00A0;skyframe&#x00A0;);
<br class="fancyvrb" /><a 
 id="x16-150006r3"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astAnnul(&#x00A0;channel&#x00A0;);</div>
<!--l. 7897--><p class="noindent" >would result in output containing only the essential information, such as:
<div class="fancyvrb" id="fancyvrb178"> <a 
 id="x16-150008r1"></a>&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyFrame&#x00A0;        #&#x00A0;Description&#x00A0;of&#x00A0;celestial&#x00A0;coordinate&#x00A0;system
<br class="fancyvrb" /><a 
 id="x16-150010r2"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Naxes&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Number&#x00A0;of&#x00A0;coordinate&#x00A0;axes<br class="fancyvrb" /><a 
 id="x16-150012r3"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax1&#x00A0;=&#x00A0;        #&#x00A0;Axis&#x00A0;number&#x00A0;1
<br class="fancyvrb" /><a 
 id="x16-150014r4"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;axis<br class="fancyvrb" /><a 
 id="x16-150016r5"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis
<br class="fancyvrb" /><a 
 id="x16-150018r6"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax2&#x00A0;=&#x00A0;        #&#x00A0;Axis&#x00A0;number&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-150020r7"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;axis
<br class="fancyvrb" /><a 
 id="x16-150022r8"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis<br class="fancyvrb" /><a 
 id="x16-150024r9"></a>&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Frame&#x00A0;        #&#x00A0;Coordinate&#x00A0;system&#x00A0;description
<br class="fancyvrb" /><a 
 id="x16-150026r10"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System&#x00A0;=&#x00A0;&#x0022;FK4-NO-E&#x0022;&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;system&#x00A0;type
<br class="fancyvrb" /><a 
 id="x16-150028r11"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Epoch&#x00A0;=&#x00A0;1958&#x00A0;        #&#x00A0;Besselian&#x00A0;epoch&#x00A0;of&#x00A0;observation<br class="fancyvrb" /><a 
 id="x16-150030r12"></a>&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyFrame</div>
                                                                                       

                                                                                       
<!--l. 7917--><p class="noindent" >In contrast, setting Full to <!--l. 7917--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">+</mo></math>1
will result in additional output lines which will reveal every last detail of the <a 
href="sun211ss464.html#x491-6830000">Object</a>&#x2019;s construction.
Often this will be rather more than you want, especially for more complex Objects, but it can
sometimes help when debugging programs. This is how a <a 
href="sun211ss478.html#x505-6970000">SkyFrame</a> appears at this level of
detail:
<div class="fancyvrb" id="fancyvrb179"> <a 
 id="x16-150032r1"></a>&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyFrame&#x00A0;        #&#x00A0;Description&#x00A0;of&#x00A0;celestial&#x00A0;coordinate&#x00A0;system
<br class="fancyvrb" /><a 
 id="x16-150034r2"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;RefCnt&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Count&#x00A0;of&#x00A0;active&#x00A0;Object&#x00A0;pointers
<br class="fancyvrb" /><a 
 id="x16-150036r3"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Nobj&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Count&#x00A0;of&#x00A0;active&#x00A0;Objects&#x00A0;in&#x00A0;same&#x00A0;class
<br class="fancyvrb" /><a 
 id="x16-150038r4"></a>&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Object&#x00A0;        #&#x00A0;Astrometry&#x00A0;Object<br class="fancyvrb" /><a 
 id="x16-150040r5"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Nin&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Number&#x00A0;of&#x00A0;input&#x00A0;coordinates
<br class="fancyvrb" /><a 
 id="x16-150042r6"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Nout&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Number&#x00A0;of&#x00A0;output&#x00A0;coordinates<br class="fancyvrb" /><a 
 id="x16-150044r7"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Invert&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Mapping&#x00A0;not&#x00A0;inverted
<br class="fancyvrb" /><a 
 id="x16-150046r8"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Fwd&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Forward&#x00A0;transformation&#x00A0;defined<br class="fancyvrb" /><a 
 id="x16-150048r9"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Inv&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Inverse&#x00A0;transformation&#x00A0;defined
<br class="fancyvrb" /><a 
 id="x16-150050r10"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Report&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Don&#x2019;t&#x00A0;report&#x00A0;coordinate&#x00A0;transformations
<br class="fancyvrb" /><a 
 id="x16-150052r11"></a>&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Mapping&#x00A0;        #&#x00A0;Mapping&#x00A0;between&#x00A0;coordinate&#x00A0;systems
<br class="fancyvrb" /><a 
 id="x16-150054r12"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Title&#x00A0;=&#x00A0;&#x0022;FK4&#x00A0;Equatorial&#x00A0;Coordinates,&#x00A0;no&#x00A0;E-terms,&#x00A0;Mean&#x00A0;Equinox&#x00A0;B1950.0,&#x00A0;Epoch&#x00A0;B1958.0&#x0022;&#x00A0;        #&#x00A0;Title&#x00A0;of&#x00A0;coordinate&#x00A0;system
<br class="fancyvrb" /><a 
 id="x16-150056r13"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Naxes&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Number&#x00A0;of&#x00A0;coordinate&#x00A0;axes<br class="fancyvrb" /><a 
 id="x16-150058r14"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Domain&#x00A0;=&#x00A0;&#x0022;SKY&#x0022;&#x00A0;        #&#x00A0;Coordinate&#x00A0;system&#x00A0;domain
<br class="fancyvrb" /><a 
 id="x16-150060r15"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Lbl1&#x00A0;=&#x00A0;&#x0022;Right&#x00A0;Ascension&#x0022;&#x00A0;        #&#x00A0;Label&#x00A0;for&#x00A0;axis&#x00A0;1
<br class="fancyvrb" /><a 
 id="x16-150062r16"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Lbl2&#x00A0;=&#x00A0;&#x0022;Declination&#x0022;&#x00A0;        #&#x00A0;Label&#x00A0;for&#x00A0;axis&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-150064r17"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Sym1&#x00A0;=&#x00A0;&#x0022;RA&#x0022;&#x00A0;        #&#x00A0;Symbol&#x00A0;for&#x00A0;axis&#x00A0;1
<br class="fancyvrb" /><a 
 id="x16-150066r18"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Sym2&#x00A0;=&#x00A0;&#x0022;Dec&#x0022;&#x00A0;        #&#x00A0;Symbol&#x00A0;for&#x00A0;axis&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-150068r19"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Uni1&#x00A0;=&#x00A0;&#x0022;hh:mm:ss.s&#x0022;&#x00A0;        #&#x00A0;Units&#x00A0;for&#x00A0;axis&#x00A0;1
<br class="fancyvrb" /><a 
 id="x16-150070r20"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Uni2&#x00A0;=&#x00A0;&#x0022;ddd:mm:ss&#x0022;&#x00A0;        #&#x00A0;Units&#x00A0;for&#x00A0;axis&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-150072r21"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Dig1&#x00A0;=&#x00A0;7&#x00A0;        #&#x00A0;Individual&#x00A0;precision&#x00A0;for&#x00A0;axis&#x00A0;1
<br class="fancyvrb" /><a 
 id="x16-150074r22"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Dig2&#x00A0;=&#x00A0;7&#x00A0;        #&#x00A0;Individual&#x00A0;precision&#x00A0;for&#x00A0;axis&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-150076r23"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Digits&#x00A0;=&#x00A0;7&#x00A0;        #&#x00A0;Default&#x00A0;formatting&#x00A0;precision
<br class="fancyvrb" /><a 
 id="x16-150078r24"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Fmt1&#x00A0;=&#x00A0;&#x0022;hms.1&#x0022;&#x00A0;        #&#x00A0;Format&#x00A0;specifier&#x00A0;for&#x00A0;axis&#x00A0;1<br class="fancyvrb" /><a 
 id="x16-150080r25"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Fmt2&#x00A0;=&#x00A0;&#x0022;dms&#x0022;&#x00A0;        #&#x00A0;Format&#x00A0;specifier&#x00A0;for&#x00A0;axis&#x00A0;2
<br class="fancyvrb" /><a 
 id="x16-150082r26"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Dir1&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Plot&#x00A0;axis&#x00A0;1&#x00A0;in&#x00A0;reverse&#x00A0;direction&#x00A0;(hint)
<br class="fancyvrb" /><a 
 id="x16-150084r27"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Dir2&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Plot&#x00A0;axis&#x00A0;2&#x00A0;in&#x00A0;conventional&#x00A0;direction&#x00A0;(hint)
<br class="fancyvrb" /><a 
 id="x16-150086r28"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Presrv&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Don&#x2019;t&#x00A0;preserve&#x00A0;target&#x00A0;axes<br class="fancyvrb" /><a 
 id="x16-150088r29"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Permut&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Axes&#x00A0;may&#x00A0;be&#x00A0;permuted&#x00A0;to&#x00A0;match
<br class="fancyvrb" /><a 
 id="x16-150090r30"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;MinAx&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Minimum&#x00A0;number&#x00A0;of&#x00A0;axes&#x00A0;to&#x00A0;match
<br class="fancyvrb" /><a 
 id="x16-150092r31"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;MaxAx&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Maximum&#x00A0;number&#x00A0;of&#x00A0;axes&#x00A0;to&#x00A0;match<br class="fancyvrb" /><a 
 id="x16-150094r32"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;MchEnd&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Match&#x00A0;initial&#x00A0;target&#x00A0;axes
<br class="fancyvrb" /><a 
 id="x16-150096r33"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Prm1&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Axis&#x00A0;1&#x00A0;not&#x00A0;permuted<br class="fancyvrb" /><a 
 id="x16-150098r34"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Prm2&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Axis&#x00A0;2&#x00A0;not&#x00A0;permuted
<br class="fancyvrb" /><a 
 id="x16-150100r35"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax1&#x00A0;=&#x00A0;        #&#x00A0;Axis&#x00A0;number&#x00A0;1<br class="fancyvrb" /><a 
 id="x16-150102r36"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;axis
<br class="fancyvrb" /><a 
 id="x16-150104r37"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;RefCnt&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Count&#x00A0;of&#x00A0;active&#x00A0;Object&#x00A0;pointers
<br class="fancyvrb" /><a 
 id="x16-150106r38"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nobj&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Count&#x00A0;of&#x00A0;active&#x00A0;Objects&#x00A0;in&#x00A0;same&#x00A0;class
<br class="fancyvrb" /><a 
 id="x16-150108r39"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Object&#x00A0;        #&#x00A0;Astrometry&#x00A0;Object<br class="fancyvrb" /><a 
 id="x16-150110r40"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Label&#x00A0;=&#x00A0;&#x0022;Angle&#x00A0;on&#x00A0;Sky&#x0022;&#x00A0;        #&#x00A0;Axis&#x00A0;Label
<br class="fancyvrb" /><a 
 id="x16-150112r41"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Symbol&#x00A0;=&#x00A0;&#x0022;delta&#x0022;&#x00A0;        #&#x00A0;Axis&#x00A0;symbol<br class="fancyvrb" /><a 
 id="x16-150114r42"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Unit&#x00A0;=&#x00A0;&#x0022;ddd:mm:ss&#x0022;&#x00A0;        #&#x00A0;Axis&#x00A0;units
<br class="fancyvrb" /><a 
 id="x16-150116r43"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Digits&#x00A0;=&#x00A0;7&#x00A0;        #&#x00A0;Default&#x00A0;formatting&#x00A0;precision
<br class="fancyvrb" /><a 
 id="x16-150118r44"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Format&#x00A0;=&#x00A0;&#x0022;dms&#x0022;&#x00A0;        #&#x00A0;Format&#x00A0;specifier<br class="fancyvrb" /><a 
 id="x16-150120r45"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Dirn&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Plot&#x00A0;in&#x00A0;conventional&#x00A0;direction
<br class="fancyvrb" /><a 
 id="x16-150122r46"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Axis&#x00A0;        #&#x00A0;Coordinate&#x00A0;axis<br class="fancyvrb" /><a 
 id="x16-150124r47"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Format&#x00A0;=&#x00A0;&#x0022;dms&#x0022;&#x00A0;        #&#x00A0;Format&#x00A0;specifier
<br class="fancyvrb" /><a 
 id="x16-150126r48"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IsLat&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Longitude&#x00A0;axis&#x00A0;(not&#x00A0;latitude)
<br class="fancyvrb" /><a 
 id="x16-150128r49"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AsTime&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Display&#x00A0;values&#x00A0;as&#x00A0;angles&#x00A0;(not&#x00A0;times)<br class="fancyvrb" /><a 
 id="x16-150130r50"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis
<br class="fancyvrb" /><a 
 id="x16-150132r51"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax2&#x00A0;=&#x00A0;        #&#x00A0;Axis&#x00A0;number&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-150134r52"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;axis
<br class="fancyvrb" /><a 
 id="x16-150136r53"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;RefCnt&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Count&#x00A0;of&#x00A0;active&#x00A0;Object&#x00A0;pointers
<br class="fancyvrb" /><a 
 id="x16-150138r54"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nobj&#x00A0;=&#x00A0;2&#x00A0;        #&#x00A0;Count&#x00A0;of&#x00A0;active&#x00A0;Objects&#x00A0;in&#x00A0;same&#x00A0;class
<br class="fancyvrb" /><a 
 id="x16-150140r55"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Object&#x00A0;        #&#x00A0;Astrometry&#x00A0;Object<br class="fancyvrb" /><a 
 id="x16-150142r56"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Label&#x00A0;=&#x00A0;&#x0022;Angle&#x00A0;on&#x00A0;Sky&#x0022;&#x00A0;        #&#x00A0;Axis&#x00A0;Label
<br class="fancyvrb" /><a 
 id="x16-150144r57"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Symbol&#x00A0;=&#x00A0;&#x0022;delta&#x0022;&#x00A0;        #&#x00A0;Axis&#x00A0;symbol<br class="fancyvrb" /><a 
 id="x16-150146r58"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Unit&#x00A0;=&#x00A0;&#x0022;ddd:mm:ss&#x0022;&#x00A0;        #&#x00A0;Axis&#x00A0;units
<br class="fancyvrb" /><a 
 id="x16-150148r59"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Digits&#x00A0;=&#x00A0;7&#x00A0;        #&#x00A0;Default&#x00A0;formatting&#x00A0;precision
<br class="fancyvrb" /><a 
 id="x16-150150r60"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Format&#x00A0;=&#x00A0;&#x0022;dms&#x0022;&#x00A0;        #&#x00A0;Format&#x00A0;specifier<br class="fancyvrb" /><a 
 id="x16-150152r61"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Dirn&#x00A0;=&#x00A0;1&#x00A0;        #&#x00A0;Plot&#x00A0;in&#x00A0;conventional&#x00A0;direction
<br class="fancyvrb" /><a 
 id="x16-150154r62"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Axis&#x00A0;        #&#x00A0;Coordinate&#x00A0;axis<br class="fancyvrb" /><a 
 id="x16-150156r63"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Format&#x00A0;=&#x00A0;&#x0022;dms&#x0022;&#x00A0;        #&#x00A0;Format&#x00A0;specifier
<br class="fancyvrb" /><a 
 id="x16-150158r64"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IsLat&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Longitude&#x00A0;axis&#x00A0;(not&#x00A0;latitude)
<br class="fancyvrb" /><a 
 id="x16-150160r65"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AsTime&#x00A0;=&#x00A0;0&#x00A0;        #&#x00A0;Display&#x00A0;values&#x00A0;as&#x00A0;angles&#x00A0;(not&#x00A0;times)
                                                                                       

                                                                                       
<br class="fancyvrb" /><a 
 id="x16-150162r66"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis<br class="fancyvrb" /><a 
 id="x16-150164r67"></a>&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Frame&#x00A0;        #&#x00A0;Coordinate&#x00A0;system&#x00A0;description
<br class="fancyvrb" /><a 
 id="x16-150166r68"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System&#x00A0;=&#x00A0;&#x0022;FK4-NO-E&#x0022;&#x00A0;        #&#x00A0;Celestial&#x00A0;coordinate&#x00A0;system&#x00A0;type
<br class="fancyvrb" /><a 
 id="x16-150168r69"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Epoch&#x00A0;=&#x00A0;1958&#x00A0;        #&#x00A0;Besselian&#x00A0;epoch&#x00A0;of&#x00A0;observation
<br class="fancyvrb" /><a 
 id="x16-150170r70"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Eqnox&#x00A0;=&#x00A0;1950&#x00A0;        #&#x00A0;Besselian&#x00A0;epoch&#x00A0;of&#x00A0;mean&#x00A0;equinox<br class="fancyvrb" /><a 
 id="x16-150172r71"></a>&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyFrame</div>
<a 
 id="x16-150173r167"></a>
<h4 class="subsectionHead"><span class="titlemark">15.10    </span> <a 
 id="x16-15100010"></a>Controlling Commenting</h4>
<!--l. 8001--><p class="noindent" >Another way of controlling output from a <a 
href="sun211ss441.html#x468-6600000">Channel</a> is <em>via</em> the boolean (integer) <a 
href="sun211ss272.html#x298-4900000">Comment</a> attribute,
which controls whether comments are appended to describe the purpose of each value. Comment has
the value 1 by default but, if set to zero, will suppress these comments. This is normally appropriate
only if you wish to minimise the amount of output, for example:
<div class="fancyvrb" id="fancyvrb180"> <a 
 id="x16-151002r1"></a>&#x00A0;&#x00A0;astSet(&#x00A0;channel,&#x00A0;&#x0022;Full=-1,&#x00A0;Comment=0&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-151004r2"></a>&#x00A0;&#x00A0;nobj&#x00A0;=&#x00A0;astWrite(&#x00A0;channel,&#x00A0;skyframe&#x00A0;);</div>
<!--l. 8015--><p class="noindent" >might result in the following more compact output:
<div class="fancyvrb" id="fancyvrb181"> <a 
 id="x16-151006r1"></a>&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyFrame<br class="fancyvrb" /><a 
 id="x16-151008r2"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Naxes&#x00A0;=&#x00A0;2<br class="fancyvrb" /><a 
 id="x16-151010r3"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax1&#x00A0;=<br class="fancyvrb" /><a 
 id="x16-151012r4"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis<br class="fancyvrb" /><a 
 id="x16-151014r5"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis<br class="fancyvrb" /><a 
 id="x16-151016r6"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax2&#x00A0;=
<br class="fancyvrb" /><a 
 id="x16-151018r7"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SkyAxis<br class="fancyvrb" /><a 
 id="x16-151020r8"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyAxis<br class="fancyvrb" /><a 
 id="x16-151022r9"></a>&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Frame<br class="fancyvrb" /><a 
 id="x16-151024r10"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System&#x00A0;=&#x00A0;&#x0022;FK4-NO-E&#x0022;<br class="fancyvrb" /><a 
 id="x16-151026r11"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Epoch&#x00A0;=&#x00A0;1958<br class="fancyvrb" /><a 
 id="x16-151028r12"></a>&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SkyFrame</div>
<a 
 id="x16-151029r168"></a>
<h4 class="subsectionHead"><span class="titlemark">15.11    </span> <a 
 id="x16-15200011"></a>Editing Textual Output</h4>
<!--l. 8036--><p class="noindent" >The safest advice about editing the textual output from <a 
href="sun211ss237.html#x262-4540000">astWrite</a> (or <a 
href="sun211ss187.html#x212-4040000">astShow</a>) is &#x201C;don&#x2019;t!&#x201D;&#x2014;unless you
know what you are doing.
<!--l. 8039--><p class="noindent" >Having given that warning, however, it is sometimes possible to make changes to the text, or even to
write entire <a 
href="sun211ss464.html#x491-6830000">Object</a> descriptions from scratch, and to read the results back in to construct new Objects.
Normally, simple changes to numerical values are safest, but be aware that this is a back door method
of creating Objects, so you are on your own! There are a number of potential pitfalls. In
particular:
     <ul class="itemize1">
     <li class="itemize"><a 
href="sun211ss160.html#x185-3770000">astRead</a> is intended for retrieving data written by astWrite and not for reading data input
     by humans. As such, the data validation provided is very limited and is certainly not
     foolproof. This makes it quite easy to construct Objects that are internally inconsistent by
     this means. In contrast, the normal programming interface incorporates numerous checks
     designed to make it impossible to construct invalid Objects. You should not necessarily
     think  you  have  found  a  bug  if  your  changes  to  an  Object&#x2019;s  textual  description  fail  to
     produce the results you expected!
     </li>
     <li class="itemize">In many instances the names associated with values in textual output will correspond
     with Object attributes. Sometimes, however, these names may differ from the attribute
     name. This is mainly because of length restrictions imposed by other common external
     formats, such as FITS headers. Some of the names used do not correspond with attributes
     at all.
                                                                                       

                                                                                       
     </li>
     <li class="itemize">It is safest to change single numerical or string values. Beware of changing the size or
     shape of Objects (<em>e.g.</em>&#x00A0;the number of axes in a <a 
href="sun211ss452.html#x479-6710000">Frame</a>). Often, these values must match
     others stored elsewhere within the Object and changing them in a haphazard fashion will
     not produce useful results.
     </li>
     <li class="itemize">Be wary about un-commenting default values. Sometimes this will work, but often these
     values are derived from other Objects stored more deeply in the structure and the proper
     place to insert a new value is not where the default itself appears.</li></ul>
<a 
 id="x16-152001r169"></a>
<h4 class="subsectionHead"><span class="titlemark">15.12    </span> <a 
 id="x16-15300012"></a>Mixing Objects with other Text</h4>
<!--l. 8079--><p class="noindent" >By default, when you use <a 
href="sun211ss160.html#x185-3770000">astRead</a> to read from a basic <a 
href="sun211ss441.html#x468-6600000">Channel</a> (&#x00A7;<a 
href="#x16-1450004">15.4<!--tex4ht:ref: ss:readingfromachannel --></a>), it is assumed that you are
reading a stream of text containing only AST Objects, which follow each other end-to-end. If any
extraneous input data are encountered which do not appear to form part of the textual
description of an <a 
href="sun211ss464.html#x491-6830000">Object</a>, then an error will result. In particular, the first input line must
identify the start of an Object description, so you cannot start reading half way through an
Object.
<!--l. 8088--><p class="noindent" >Sometimes, however, you may want to store AST Object descriptions intermixed with other textual
data. You can do this by setting the Channel&#x2019;s boolean (integer) <a 
href="sun211ss393.html#x419-6110000">Skip</a> attribute to 1. This will cause
every read to skip over extraneous data until the start of a new AST Object description, if any, is
found. So long as your other data do not mimic the appearance of an AST Object description, the two
sets of data can co-exist.
<!--l. 8096--><p class="noindent" >For example, by setting Skip to 1, the following complete C program will read all the AST Objects
whose descriptions appear in the source of this document, ignoring the other text. <a 
href="sun211ss187.html#x212-4040000">astShow</a> is used to
display those found:
<div class="fancyvrb" id="fancyvrb182"> <a 
 id="x16-153002r1"></a>&#x00A0;&#x00A0;#include&#x00A0;&#x0022;ast.h&#x0022;<br class="fancyvrb" /><a 
 id="x16-153004r2"></a>&#x00A0;&#x00A0;main()&#x00A0;{<br class="fancyvrb" /><a 
 id="x16-153006r3"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AstChannel&#x00A0;*channel;<br class="fancyvrb" /><a 
 id="x16-153008r4"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AstObject&#x00A0;*object;<br class="fancyvrb" /><a 
 id="x16-153010r5"></a>&#x00A0;&#x00A0;
<br class="fancyvrb" /><a 
 id="x16-153012r6"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astChannel(&#x00A0;NULL,&#x00A0;NULL,&#x00A0;&#x0022;Skip=1&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-153014r7"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;while&#x00A0;(&#x00A0;(&#x00A0;object&#x00A0;=&#x00A0;astRead(&#x00A0;channel&#x00A0;)&#x00A0;)&#x00A0;!=&#x00A0;AST__NULL&#x00A0;)&#x00A0;{
<br class="fancyvrb" /><a 
 id="x16-153016r8"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;astShow(&#x00A0;object&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-153018r9"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;object&#x00A0;=&#x00A0;astAnnul(&#x00A0;object&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-153020r10"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}<br class="fancyvrb" /><a 
 id="x16-153022r11"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astAnnul(&#x00A0;channel&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-153024r12"></a>&#x00A0;&#x00A0;}</div>
<a 
 id="x16-153025r170"></a>
<h4 class="subsectionHead"><span class="titlemark">15.13    </span> <a 
 id="x16-15400013"></a>Reading Objects from Files</h4>
<!--l. 8120--><p class="noindent" >Thus far, we have only considered the default behaviour of a <a 
href="sun211ss441.html#x468-6600000">Channel</a> in reading and writing Objects
through a program&#x2019;s standard input and output streams. We will now consider how to access Objects
stored in files more directly.
<!--l. 8125--><p class="noindent" >The simple approach is to use the <a 
href="sun211ss390.html#x416-6080000">SinkFile</a> and <a 
href="sun211ss399.html#x425-6170000">SourceFile</a> attributes of the Channel. For instance, the
following will read a pair of Objects from a text file called &#x201C;fred.txt&#x201D;:
<div class="fancyvrb" id="fancyvrb183"> <a 
 id="x16-154002r1"></a>&#x00A0;&#x00A0;astSet(&#x00A0;channel,&#x00A0;&#x0022;SourceFile=fred.txt&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-154004r2"></a>&#x00A0;&#x00A0;obj1&#x00A0;=&#x00A0;astRead(&#x00A0;channel&#x00A0;);
<br class="fancyvrb" /><a 
 id="x16-154006r3"></a>&#x00A0;&#x00A0;obj2&#x00A0;=&#x00A0;astRead(&#x00A0;channel&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-154008r4"></a>&#x00A0;&#x00A0;astClear(&#x00A0;channel,&#x00A0;&#x0022;SourceFile&#x0022;&#x00A0;);</div>
                                                                                       

                                                                                       
<!--l. 8138--><p class="noindent" >Note, the act of clearing the attribute tells AST that no more Objects are to be read from the file
and so the file is then closed. If the attribute is not cleared, the file will remain open and
further Objects can be read from it. The file will always be closed when the Channel is
deleted.
<!--l. 8144--><p class="noindent" >This simple approach will normally be sufficient. However, because the AST library is designed to be
used from more than one language, it has to be a little careful about reading and writing to files. This
is due to incompatibilities that may exist between the file I/O facilities provided by different
languages. If such incompatibilities prevent the above simple system being used, we need to adopt a
system that off-loads all file I/O to external code.
<!--l. 8152--><p class="noindent" >What this means in practice is that if the above simple approach cannot be used, you must instead
provide some simple C functions that perform the actual transfer of data to and from files and similar
external data stores. The functions you provide are supplied as the source and/or sink function
arguments to <a 
href="sun211ss17.html#x42-2340000">astChannel</a> when you create a Channel (&#x00A7;<a 
href="#x16-1430002">15.2<!--tex4ht:ref: ss:creatingachannel --></a>). An example is the best way to illustrate
this.
<!--l. 8160--><p class="noindent" >Consider the following simple function called Source. It reads a single line of text from a C input
stream and returns a pointer to it, or NULL if there is no more input:
<div class="fancyvrb" id="fancyvrb184"> <a 
 id="x16-154010r1"></a>&#x00A0;&#x00A0;#include&#x00A0;&#x003C;stdio.h&#x003E;<br class="fancyvrb" /><a 
 id="x16-154012r2"></a>&#x00A0;&#x00A0;#define&#x00A0;LEN&#x00A0;200<br class="fancyvrb" /><a 
 id="x16-154014r3"></a>&#x00A0;&#x00A0;static&#x00A0;FILE&#x00A0;*input_stream;<br class="fancyvrb" /><a 
 id="x16-154016r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-154018r5"></a>&#x00A0;&#x00A0;const&#x00A0;char&#x00A0;*Source(&#x00A0;void&#x00A0;)&#x00A0;{
<br class="fancyvrb" /><a 
 id="x16-154020r6"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;static&#x00A0;char&#x00A0;buffer[&#x00A0;LEN&#x00A0;+&#x00A0;2&#x00A0;];<br class="fancyvrb" /><a 
 id="x16-154022r7"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;fgets(&#x00A0;buffer,&#x00A0;LEN&#x00A0;+&#x00A0;2,&#x00A0;input_stream&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-154024r8"></a>&#x00A0;&#x00A0;}</div>
<!--l. 8177--><p class="noindent" >Note that the input stream is a static variable which we will also access from our main program. This
might look something like this (omitting error checking for brevity):
<div class="fancyvrb" id="fancyvrb185"> <a 
 id="x16-154026r1"></a>&#x00A0;&#x00A0;/*&#x00A0;Open&#x00A0;the&#x00A0;input&#x00A0;file.&#x00A0;*/<br class="fancyvrb" /><a 
 id="x16-154028r2"></a>&#x00A0;&#x00A0;input_stream&#x00A0;=&#x00A0;fopen(&#x00A0;&#x0022;infile.ast&#x0022;,&#x00A0;&#x0022;r&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-154030r3"></a>&#x00A0;&#x00A0;
<br class="fancyvrb" /><a 
 id="x16-154032r4"></a>&#x00A0;&#x00A0;/*&#x00A0;Create&#x00A0;a&#x00A0;Channel&#x00A0;and&#x00A0;read&#x00A0;an&#x00A0;Object&#x00A0;from&#x00A0;it.&#x00A0;*/<br class="fancyvrb" /><a 
 id="x16-154034r5"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astChannel(&#x00A0;Source,&#x00A0;NULL,&#x00A0;&#x0022;&#x0022;&#x00A0;);
<br class="fancyvrb" /><a 
 id="x16-154036r6"></a>&#x00A0;&#x00A0;object&#x00A0;=&#x00A0;astRead(&#x00A0;channel&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-154038r7"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-154040r8"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x16-154042r9"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-154044r10"></a>&#x00A0;&#x00A0;/*&#x00A0;Annul&#x00A0;the&#x00A0;Channel&#x00A0;and&#x00A0;close&#x00A0;the&#x00A0;file&#x00A0;when&#x00A0;done.&#x00A0;*/
<br class="fancyvrb" /><a 
 id="x16-154046r11"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astAnnul(&#x00A0;channel&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-154048r12"></a>&#x00A0;&#x00A0;(void)&#x00A0;fclose(&#x00A0;input_stream&#x00A0;);</div>
<!--l. 8198--><p class="noindent" >Here, we first open the required input file, saving the resulting FILE pointer. We then pass a pointer to
our Source function as the first argument to astChannel when creating a new Channel. When we read
an <a 
href="sun211ss464.html#x491-6830000">Object</a> from this Channel with <a 
href="sun211ss160.html#x185-3770000">astRead</a>, the Source function will be called to obtain
the textual data from the file, the end-of-file being detected when this function returns
NULL.
<!--l. 8205--><p class="noindent" >Note, if a value is set for the SourceFile attribute, the astRead function will ignore any source function
specified when the Channel was created.
<a 
 id="x16-154049r171"></a>
<h4 class="subsectionHead"><span class="titlemark">15.14    </span> <a 
 id="x16-15500014"></a>Writing Objects to Files</h4>
<!--l. 8211--><p class="noindent" >As for reading, writing Objects to files can be done in two different ways. Again, the simple approach
is to use the <a 
href="sun211ss390.html#x416-6080000">SinkFile</a> attribute of the <a 
href="sun211ss441.html#x468-6600000">Channel</a>. For instance, the following will write a pair of Objects to
a text file called &#x201C;fred.txt&#x201D;:
<div class="fancyvrb" id="fancyvrb186"> <a 
 id="x16-155002r1"></a>&#x00A0;&#x00A0;astSet(&#x00A0;channel,&#x00A0;&#x0022;SinkFile=fred.txt&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-155004r2"></a>&#x00A0;&#x00A0;nobj&#x00A0;=&#x00A0;astWrite(&#x00A0;channel,&#x00A0;object1&#x00A0;);
<br class="fancyvrb" /><a 
 id="x16-155006r3"></a>&#x00A0;&#x00A0;nobj&#x00A0;=&#x00A0;astWrite(&#x00A0;channel,&#x00A0;object2&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-155008r4"></a>&#x00A0;&#x00A0;astClear(&#x00A0;channel,&#x00A0;&#x0022;SinkFile&#x0022;&#x00A0;);</div>
                                                                                       

                                                                                       
<!--l. 8225--><p class="noindent" >Note, the act of clearing the attribute tells AST that no more output will be written to the file
and so the file is then closed. If the attribute is not cleared, the file will remain open and
further Objects can be written to it. The file will always be closed when the Channel is
deleted.
<!--l. 8231--><p class="noindent" >If the details of the language&#x2019;s I/O system on the computer you are using means that the above
approach cannot be used, then we can write a Sink function, that writes a line of output text to a
file, and use it in basically the same way as the Source function in the previous section
(&#x00A7;<a 
href="#x16-15400013">15.13<!--tex4ht:ref: ss:channelsource --></a>):
<div class="fancyvrb" id="fancyvrb187"> <a 
 id="x16-155010r1"></a>&#x00A0;&#x00A0;static&#x00A0;FILE&#x00A0;*output_stream;<br class="fancyvrb" /><a 
 id="x16-155012r2"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-155014r3"></a>&#x00A0;&#x00A0;void&#x00A0;Sink(&#x00A0;const&#x00A0;char&#x00A0;*line&#x00A0;)&#x00A0;{
<br class="fancyvrb" /><a 
 id="x16-155016r4"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(void)&#x00A0;fprintf(&#x00A0;output_stream,&#x00A0;&#x0022;%s&#x005C;n&#x0022;,&#x00A0;line&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-155018r5"></a>&#x00A0;&#x00A0;}</div>
<!--l. 8246--><p class="noindent" >Note that we must supply the final newline character ourselves.
<!--l. 8248--><p class="noindent" >In this case, our main program would supply a pointer to this Sink function as the second argument to
<a 
href="sun211ss17.html#x42-2340000">astChannel</a>, as follows:
<div class="fancyvrb" id="fancyvrb188"> <a 
 id="x16-155020r1"></a>&#x00A0;&#x00A0;/*&#x00A0;Open&#x00A0;the&#x00A0;output&#x00A0;file.&#x00A0;*/<br class="fancyvrb" /><a 
 id="x16-155022r2"></a>&#x00A0;&#x00A0;output_stream&#x00A0;=&#x00A0;fopen(&#x00A0;&#x0022;outfile.ast&#x0022;,&#x00A0;&#x0022;w&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-155024r3"></a>&#x00A0;&#x00A0;
<br class="fancyvrb" /><a 
 id="x16-155026r4"></a>&#x00A0;&#x00A0;/*&#x00A0;Create&#x00A0;a&#x00A0;Channel&#x00A0;and&#x00A0;write&#x00A0;an&#x00A0;Object&#x00A0;to&#x00A0;it.&#x00A0;*/<br class="fancyvrb" /><a 
 id="x16-155028r5"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astChannel(&#x00A0;Source,&#x00A0;Sink,&#x00A0;&#x0022;&#x0022;&#x00A0;);
<br class="fancyvrb" /><a 
 id="x16-155030r6"></a>&#x00A0;&#x00A0;nobj&#x00A0;=&#x00A0;astWrite(&#x00A0;channel,&#x00A0;object&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-155032r7"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-155034r8"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x16-155036r9"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x16-155038r10"></a>&#x00A0;&#x00A0;/*&#x00A0;Annul&#x00A0;the&#x00A0;Channel&#x00A0;and&#x00A0;close&#x00A0;the&#x00A0;file&#x00A0;when&#x00A0;done.&#x00A0;*/
<br class="fancyvrb" /><a 
 id="x16-155040r11"></a>&#x00A0;&#x00A0;channel&#x00A0;=&#x00A0;astAnnul(&#x00A0;channel&#x00A0;);<br class="fancyvrb" /><a 
 id="x16-155042r12"></a>&#x00A0;&#x00A0;(void)&#x00A0;fclose(&#x00A0;output_stream&#x00A0;);</div>
<!--l. 8268--><p class="noindent" >Note that we can specify a source and/or a sink function for the Channel, and that these may use
either the same file, or different files according to whether we are reading or writing. AST has no
knowledge of the underlying file system, nor of file positioning. It just reads and writes sequentially. If
you wish, for example, to reposition a file at the beginning in between reads and writes,
then this can be done directly (and completely independently of AST) using standard C
functions.
<!--l. 8277--><p class="noindent" >If an error occurs in your source or sink function, you can communicate this to the AST library by
setting its error status to any error value using <a 
href="sun211ss184.html#x209-4010000">astSetStatus</a> (&#x00A7;<a 
href="sun211se4.html#x5-5100015">4.15<!--tex4ht:ref: ss:errordetection --></a>). This will immediately terminate
the read or write operation.
<!--l. 8282--><p class="noindent" >Note, if a value is set for the SinkFile attribute, the <a 
href="sun211ss237.html#x262-4540000">astWrite</a> function will ignore any sink function
specified when the Channel was created.
<a 
 id="x16-155043r172"></a>
<h4 class="subsectionHead"><span class="titlemark">15.15    </span> <a 
 id="x16-15600015"></a>Reading and Writing Objects to other Places</h4>
<!--l. 8288--><p class="noindent" >It should be obvious from the above (&#x00A7;<a 
href="#x16-15400013">15.13<!--tex4ht:ref: ss:channelsource --></a> and &#x00A7;<a 
href="#x16-15500014">15.14<!--tex4ht:ref: ss:channelsink --></a>) that a <a 
href="sun211ss441.html#x468-6600000">Channel</a>&#x2019;s source and sink functions
provide a flexible means of intercepting textual data that describes AST Objects as it flows in and out
of your program. In fact, you might like to regard a Channel simply as a filter for converting AST
Objects to and from a stream of text which is then handled by your source and sink functions, where
the real I/O occurs.
<!--l. 8296--><p class="noindent" >This gives you the ability to store AST Objects in virtually any data system, so long as you can convert
a stream of text into something that can be stored (it need no longer be text) and retrieve it again.
There is generally no need to retain comments. Other possibilities, such as inter-process and network
communication, could also be implemented <em>via</em> source and sink functions in basically the same
way.
                                                                                       

                                                                                       
                                                                                       

                                                                                       
<div class="crosslinks"> <div class="copyright"><span class="pushright">Copyright (C) 2014 Science &#x0026; Technology Facilities Council</span></div> <ul class='nav'> <li class="prev"> <a 
href="sun211se14.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for Handling<BR>World
Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211se16.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li> </ul></div>
<!--l. 8305--><p class="noindent" ><a 
 id="tailsun211se15.html"></a> 
</body> 
</html>