<!DOCTYPE html> 
<html> 
<head><title>Spectral Coordinate Systems (SpecFrames)</title> 
<meta charset=utf-8/> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<link rel="stylesheet" type="text/css" href="sun211.css" /> 
 <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML"></script><style type="text/css">.MathJax_MathML {text-indent: 0;}</style></head><body 
>
<div class="crosslinks"><ul class='nav'> <li class="prev"> <a 
href="sun211se8.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for Handling<BR>World Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211se10.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li>
</ul></div>
<h3 class="sectionHead"><span class="titlemark">9    </span> <a 
 id="x10-990009"></a><a name="xref_ss_specframes"></a>Spectral Coordinate Systems (SpecFrames)</h3>
<div class="sectionTOCS">
&#x00A0;<span class="subsectionToc" >9.1 <a 
href="#x10-1000001">The SpecFrame Model</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.2 <a 
href="#x10-1010002">Creating a SpecFrame</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.3 <a 
href="#x10-1020003">Specifying a Particular Spectral Coordinate System</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.4 <a 
href="#x10-1030004">Attributes which Qualify Spectral Coordinate Systems</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.5 <a 
href="#x10-1040005">Using Default SpecFrame Attributes</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.6 <a 
href="#x10-1050006">Creating Spectral Cubes</a></span>
<br />&#x00A0;<span class="subsectionToc" >9.7 <a 
href="#x10-1060007">Handling Dual-Sideband Spectra</a></span>
</div>
<!--l. 5354--><p class="noindent" >The <a 
href="sun211ss481.html#x508-7000000">SpecFrame</a> is a <a 
href="sun211ss452.html#x479-6710000">Frame</a> which is specialised for representing coordinate systems which
describe a position within an electro-magnetic spectrum. In this section we examine the
additional properties and behaviour of a SpecFrame that distinguish it from a basic Frame
(&#x00A7;<a 
href="sun211se7.html#x8-730007">7<!--tex4ht:ref: ss:frames --></a>).
<a 
 id="x10-99001r110"></a>
<h4 class="subsectionHead"><span class="titlemark">9.1    </span> <a 
 id="x10-1000001"></a>The SpecFrame Model</h4>
<!--l. 5361--><p class="noindent" >As for a <a 
href="sun211ss478.html#x505-6970000">SkyFrame</a>, a <a 
href="sun211ss481.html#x508-7000000">SpecFrame</a> is a <a 
href="sun211ss452.html#x479-6710000">Frame</a> (&#x00A7;<a 
href="sun211se7.html#x8-730007">7<!--tex4ht:ref: ss:frames --></a>) and also a <a 
href="sun211ss459.html#x486-6780000">Mapping</a> (&#x00A7;<a 
href="sun211se5.html#x6-530005">5<!--tex4ht:ref: ss:mappings --></a>), so it inherits all the
properties and behaviour of these two ancestral classes. When used as a Mapping, a SpecFrame
implements a unit transformation, exactly like a basic Frame (&#x00A7;<a 
href="sun211se7.html#x8-760003">7.3<!--tex4ht:ref: ss:frameasmapping --></a>) or a <a 
href="sun211ss495.html#x522-7140000">UnitMap</a>, so this aspect of its
behaviour is not of great importance.
<!--l. 5368--><p class="noindent" >When used as a Frame, however, a SpecFrame represents a wide range of different 1-dimensional
coordinate system which can be used to describe positions within a spectrum. The options available
largely mirror those described in the FITS-WCS paper III <em>Representations of spectral coordinates in FITS</em>
(Greisen, Valdes, Calabretta &#x0026; Allen).
<a 
 id="x10-100001r112"></a>
                                                                                       

                                                                                       
<h4 class="subsectionHead"><span class="titlemark">9.2    </span> <a 
 id="x10-1010002"></a>Creating a SpecFrame</h4>
<!--l. 5376--><p class="noindent" >The <a 
href="sun211ss481.html#x508-7000000">SpecFrame</a> constructor function is particularly simple and a SpecFrame with default attributes is
created as follows:
<div class="fancyvrb" id="fancyvrb112"> <a 
 id="x10-101002r1"></a>&#x00A0;&#x00A0;#include&#x00A0;&#x0022;ast.h&#x0022;<br class="fancyvrb" /><a 
 id="x10-101004r2"></a>&#x00A0;&#x00A0;AstSpecFrame&#x00A0;*specframe;<br class="fancyvrb" /><a 
 id="x10-101006r3"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x10-101008r4"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x10-101010r5"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x10-101012r6"></a>&#x00A0;&#x00A0;specframe&#x00A0;=&#x00A0;astSpecFrame(&#x00A0;&#x0022;&#x0022;&#x00A0;);</div>
<!--l. 5390--><p class="noindent" >Such a SpecFrame would represent the default coordinate system which is heliocentric wavelength in
metres (i.e. wavelength corrected to take into account the Doppler shift caused by the velocity of the
observer around the sun).
<a 
 id="x10-101013r113"></a>
<h4 class="subsectionHead"><span class="titlemark">9.3    </span> <a 
 id="x10-1020003"></a>Specifying a Particular Spectral Coordinate System</h4>
<!--l. 5397--><p class="noindent" >Selection of a particular coordinate system is performed simply by setting a value for the
<a 
href="sun211ss481.html#x508-7000000">SpecFrame</a>&#x2019;s (character string) <a 
href="sun211ss413.html#x439-6310000">System</a> attribute. This setting is most conveniently done when the
SpecFrame is created. For example, a SpecFrame representing Energy would be created
by:
<div class="fancyvrb" id="fancyvrb113"> <a 
 id="x10-102002r1"></a>&#x00A0;&#x00A0;specframe&#x00A0;=&#x00A0;astSpecFrame(&#x00A0;&#x0022;System=Energy&#x0022;&#x00A0;);</div>
<!--l. 5408--><p class="noindent" >Note that specifying &#x201C;System<!--l. 5408--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">=</mo></math>Energy&#x201D;
also changes the associated Unit (from metres to Joules). This is because the default value of the
SpecFrame&#x2019;s Unit attribute depends on the System attribute setting.
<!--l. 5412--><p class="noindent" >You may change the System value at any time, although this is not usually needed. The
values supported are set out in the attribute&#x2019;s description in Appendix&#x00A0;<a 
href="sun211se25.html#x266-4580003">C<!--tex4ht:ref: ss:attributedescriptions --></a> and include a
variety of velocity systems, together with frequency, wavelength, energy, wave-number,
<em>etc</em>.
<a 
 id="x10-102003r114"></a>
<h4 class="subsectionHead"><span class="titlemark">9.4    </span> <a 
 id="x10-1030004"></a>Attributes which Qualify Spectral Coordinate Systems</h4>
<!--l. 5420--><p class="noindent" >Many spectral coordinate systems have some additional free parameters which serve to identify a
particular coordinate system from amongst a broader class of related coordinate systems. For
example, the velocity systems are all parameterised by a rest frequency&#x2014;the frequency which defines
zero velocity, and all coordinate systems are qualified by a &#x2018;standard of rest&#x201D; which indicates the rest
frame to which the values refer.
<!--l. 5428--><p class="noindent" >In AST, these free parameters are represented by additional <a 
href="sun211ss481.html#x508-7000000">SpecFrame</a> attributes, each of which has a
default appropriate to (<em>i.e.</em>&#x00A0;defined by) the setting of the main <a 
href="sun211ss413.html#x439-6310000">System</a> attribute. Each of these
<em>qualifying attributes</em> may, however, be assigned an explicit value so as to select a particular coordinate
system. Note, it is usually best to assign explicit values whenever possible rather than relying on
defaults. Attribute should only be left at their default value if you &#x201C;don&#x2019;t care&#x201D; what value is used. In
certain circumstances (particularly, when aligning two Frames), a default value for an attribute
may be replaced by the value from another similar <a 
href="sun211ss452.html#x479-6710000">Frame</a>. Such value replacement can be
prevented by assigning an explicit value to the attribute, rather than simply relying on the
default.
                                                                                       

                                                                                       
<!--l. 5443--><p class="noindent" >The main SpecFrame attributes which qualify the System attribute are:
     <div class="quote">
     <dl class="description"><dt class="description">
<a 
href="sun211ss285.html#x311-5030000">Epoch</a> </dt><dd 
class="description"><br 
class="newline" />This attribute is inherited from the Frame class. It gives the moment in time
     when  the  coordinates  are  correct  for  the  astronomical  source  under  study
     (usually the date of observation). It is needed in order to calculate the Doppler
     shift produced by the velocity of the observer relative to the centre of the earth,
     and of the earth relative to the sun.
     </dd><dt class="description">
<a 
href="sun211ss409.html#x435-6270000">StdOfRest</a> </dt><dd 
class="description"><br 
class="newline" />This specifies the rest frame in which the coordinates are correct. Transforming
     between different standards of rest involves taking account of the Doppler shift
     introduced by the relative motion of the two standards of rest.
     </dd><dt class="description">
<a 
href="sun211ss383.html#x409-6010000">RestFreq</a> </dt><dd 
class="description"><br 
class="newline" />Specifies  the  frequency  which  correspond  to  zero  velocity.  When  setting  a
     value for this attribute, the value may be supplied as a wavelength (including
     an indication of the units being used, &#x201C;nm&#x201D; &#x201C;Angstrom&#x201D;, <em>etc.</em>), which will be
     automatically be converted to a frequency.
     </dd><dt class="description">
<a 
href="sun211ss379.html#x405-5970000">RefRA</a> </dt><dd 
class="description"><br 
class="newline" />Specifies  the  RA  (FK5  J2000)  of  the  source.  This  is  used  when  converting
     between standards of rest. It specifies the direction along which the component
     of the relative velocity of the two standards of rest is taken.
     </dd><dt class="description">
<a 
href="sun211ss378.html#x404-5960000">RefDec</a> </dt><dd 
class="description"><br 
class="newline" />Specifies the Dec (FK5 J2000) of the source. Used in conjunction with REFRA.
     </dd><dt class="description">
<a 
href="sun211ss402.html#x428-6200000">SourceVel</a> </dt><dd 
class="description"><br 
class="newline" />This defines the &#x201C;source&#x201D; standard of rest. This is a rest frame which is moving
     towards  the  position  given  by  RefRA  and  RefDec,  at  a  velocity  given  by
     SourceVel. The velocity is stored internally as a heliocentric velocity, but can
     be given in any of the other supported standards of rest.
     </dd></dl>
     </div>
<!--l. 5485--><p class="noindent" >For further details of these attributes you should consult their descriptions in Appendix&#x00A0;<a 
href="sun211se25.html#x266-4580003">C<!--tex4ht:ref: ss:attributedescriptions --></a> and for
details of the System settings for which they are relevant, see the description of the System attribute
(also in Appendix&#x00A0;<a 
href="sun211se25.html#x266-4580003">C<!--tex4ht:ref: ss:attributedescriptions --></a>).
<!--l. 5490--><p class="noindent" >Note that it does no harm to assign values to qualifying attributes which are not relevant to the main
System value. Any such values are stored, but are not used unless the System value is later set so that
they become relevant.
<a 
 id="x10-103001r115"></a>
                                                                                       

                                                                                       
<h4 class="subsectionHead"><span class="titlemark">9.5    </span> <a 
 id="x10-1040005"></a>Using Default SpecFrame Attributes</h4>
<!--l. 5497--><p class="noindent" >The default values supplied for many <a 
href="sun211ss481.html#x508-7000000">SpecFrame</a> attributes will depend on the value of the
SpecFrame&#x2019;s <a 
href="sun211ss413.html#x439-6310000">System</a> attribute. In practice, this means that there is usually little need to specify many
of these attributes explicitly unless you have some special requirement. This can be illustrated by
using <a 
href="sun211ss187.html#x212-4040000">astShow</a> to examine a SpecFrame, as follows:
<div class="fancyvrb" id="fancyvrb114"> <a 
 id="x10-104002r1"></a>&#x00A0;&#x00A0;astShow(&#x00A0;astSpecFrame(&#x00A0;&#x0022;System=Vopt,&#x00A0;RestFreq=250&#x00A0;GHz&#x0022;&#x00A0;)&#x00A0;);</div>
<!--l. 5509--><p class="noindent" >The output from this might look like the following:
<div class="fancyvrb" id="fancyvrb115"> <a 
 id="x10-104004r1"></a>&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;SpecFrame&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Description&#x00A0;of&#x00A0;spectral&#x00A0;coordinate&#x00A0;system
<br class="fancyvrb" /><a 
 id="x10-104006r2"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Title&#x00A0;=&#x00A0;&#x0022;Optical&#x00A0;velocity,&#x00A0;rest&#x00A0;frequency&#x00A0;=&#x00A0;250&#x00A0;GHz&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Title<br class="fancyvrb" /><a 
 id="x10-104008r3"></a>&#x00A0;&#x00A0;of&#x00A0;coordinate&#x00A0;system
<br class="fancyvrb" /><a 
 id="x10-104010r4"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Naxes&#x00A0;=&#x00A0;1&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Number&#x00A0;of&#x00A0;coordinate&#x00A0;axes<br class="fancyvrb" /><a 
 id="x10-104012r5"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Domain&#x00A0;=&#x00A0;&#x0022;SPECTRUM&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Coordinate&#x00A0;system&#x00A0;domain
<br class="fancyvrb" /><a 
 id="x10-104014r6"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Epoch&#x00A0;=&#x00A0;2000&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Julian&#x00A0;epoch&#x00A0;of&#x00A0;observation<br class="fancyvrb" /><a 
 id="x10-104016r7"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Lbl1&#x00A0;=&#x00A0;&#x0022;Optical&#x00A0;velocity&#x0022;&#x00A0;&#x00A0;#&#x00A0;Label&#x00A0;for&#x00A0;axis&#x00A0;1
<br class="fancyvrb" /><a 
 id="x10-104018r8"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System&#x00A0;=&#x00A0;&#x0022;VOPT&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Coordinate&#x00A0;system&#x00A0;type<br class="fancyvrb" /><a 
 id="x10-104020r9"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Uni1&#x00A0;=&#x00A0;&#x0022;km/s&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Units&#x00A0;for&#x00A0;axis&#x00A0;1
<br class="fancyvrb" /><a 
 id="x10-104022r10"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ax1&#x00A0;=&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Axis&#x00A0;number&#x00A0;1<br class="fancyvrb" /><a 
 id="x10-104024r11"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Begin&#x00A0;Axis&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Coordinate&#x00A0;axis<br class="fancyvrb" /><a 
 id="x10-104026r12"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;End&#x00A0;Axis
<br class="fancyvrb" /><a 
 id="x10-104028r13"></a>&#x00A0;&#x00A0;&#x00A0;IsA&#x00A0;Frame&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Coordinate&#x00A0;system&#x00A0;description<br class="fancyvrb" /><a 
 id="x10-104030r14"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;SoR&#x00A0;=&#x00A0;&#x0022;Heliocentric&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Standard&#x00A0;of&#x00A0;rest
<br class="fancyvrb" /><a 
 id="x10-104032r15"></a>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;RstFrq&#x00A0;=&#x00A0;250000000000&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Rest&#x00A0;frequency&#x00A0;(Hz)<br class="fancyvrb" /><a 
 id="x10-104034r16"></a>&#x00A0;&#x00A0;&#x00A0;End&#x00A0;SpecFrame</div>
<!--l. 5530--><p class="noindent" >Note that the defaults (indicated by the &#x201C;<span class="obeylines-h"><span class="verb">#</span></span>&#x201D; comment character at the start of the line) for attributes
such as the <a 
href="sun211ss420.html#x446-6380000">Title</a>, axis Labels and Unit specifiers are all set to values appropriate for the particular
velocity system that the SpecFrame represents.
<!--l. 5535--><p class="noindent" >These choices would be appropriate for a System value of &#x201C;Vopt&#x201D;, but if a different System value were set,
the defaults would be correspondingly different. For example, by default frequency is measured in units of
GHz, not <!--l. 5538--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi><mi 
>m</mi><mo 
class="MathClass-bin">/</mo><mi 
>s</mi></math>,
so setting &#x201C;System=freq&#x201D; would change the appropriate line above from:
<div class="fancyvrb" id="fancyvrb116"> <a 
 id="x10-104036r1"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Uni1&#x00A0;=&#x00A0;&#x0022;km/s&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Units&#x00A0;for&#x00A0;axis&#x00A0;1</div>
<!--l. 5545--><p class="noindent" >to
<div class="fancyvrb" id="fancyvrb117"> <a 
 id="x10-104038r1"></a>&#x00A0;&#x00A0;#&#x00A0;&#x00A0;&#x00A0;Uni1&#x00A0;=&#x00A0;&#x0022;GHz&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Units&#x00A0;for&#x00A0;axis&#x00A0;1</div>
<!--l. 5551--><p class="noindent" >Of course, if you do not like any of these defaults, you may always over-ride them by setting
explicit attribute values yourself. For instance, you may choose to have your frequency
axis expressed in &#x201C;kHz&#x201D; rather than &#x201C;GHz&#x201D;. To do this simply set the attribute value as
follows:
<div class="fancyvrb" id="fancyvrb118"> <a 
 id="x10-104040r1"></a>&#x00A0;&#x00A0;astSetC(&#x00A0;specframe,&#x00A0;&#x0022;Unit&#x0022;,&#x00A0;&#x0022;kHz&#x0022;&#x00A0;);</div>
                                                                                       

                                                                                       
<!--l. 5562--><p class="noindent" >No error will be reported if you accidentally set an inappropriate Unit value (say &#x0022;J&#x0022; - Joules)&#x2014;after
all, AST cannot tell what you are about to do, and you <em>may</em> be about to change the System value to
&#x201C;Energy&#x201D;. However, an error <em>will</em> be reported if you attempt to find a conversion between two
SpecFrames (for instance using <a 
href="sun211ss32.html#x57-2490000">astConvert</a> ) if either SpecFrame has a Unit value which is
inappropriate for its System value.
<!--l. 5571--><p class="noindent" >SpecFrame attributes, like all other attributes, all have default value. However, be aware that for some
attributes these default values can never be more than &#x201C;a legal numerical value&#x201D; and have no
astronomical significance. For instance, the <a 
href="sun211ss379.html#x405-5970000">RefRA</a> and <a 
href="sun211ss378.html#x404-5960000">RefDec</a> attributes (which give the source
position) both have a default value of zero. So unless your source happens to be at that point
(highly unlikely!) you will need to set new values. Likewise, the <a 
href="sun211ss383.html#x409-6010000">RestFreq</a> (rest frequency)
attribute has an arbitrary default value of 1.0E5 GHz. Some operations are not affected by
inappropriate values for these attributes (for instance, converting from frequency to wavelength,
changing axis units, <em>etc</em>), but some are. For instance, converting from frequency to velocity
requires a correct rest frequency, moving between different standards of rest requires a
correct source position. The moral is, always set explicit values for as many attributes as
possible.
<a 
 id="x10-104041r116"></a>
<h4 class="subsectionHead"><span class="titlemark">9.6    </span> <a 
 id="x10-1050006"></a>Creating Spectral Cubes</h4>
<!--l. 5587--><p class="noindent" >You can use a <a 
href="sun211ss481.html#x508-7000000">SpecFrame</a> to describe the spectral axis in a data cube containing two spatial axes and a
spectral axis. To do this you would create an appropriate SpecFrame, together with a 2-dimensional
<a 
href="sun211ss452.html#x479-6710000">Frame</a> (often a <a 
href="sun211ss478.html#x505-6970000">SkyFrame</a>) to describe the spatial axes. You would then combine these two Frames
together into a single <a 
href="sun211ss443.html#x470-6620000">CmpFrame</a>.
<div class="fancyvrb" id="fancyvrb119"> <a 
 id="x10-105002r1"></a>&#x00A0;&#x00A0;AstSkyFrame&#x00A0;*skyframe;<br class="fancyvrb" /><a 
 id="x10-105004r2"></a>&#x00A0;&#x00A0;AstSpecFrame&#x00A0;*specframe;<br class="fancyvrb" /><a 
 id="x10-105006r3"></a>&#x00A0;&#x00A0;AstCmpFrame&#x00A0;*cmpframe;<br class="fancyvrb" /><a 
 id="x10-105008r4"></a>&#x00A0;&#x00A0;...
<br class="fancyvrb" /><a 
 id="x10-105010r5"></a>&#x00A0;&#x00A0;skyframe&#x00A0;=&#x00A0;astSkyFrame(&#x00A0;&#x0022;Epoch=J2002&#x0022;&#x00A0;);<br class="fancyvrb" /><a 
 id="x10-105012r6"></a>&#x00A0;&#x00A0;specframe&#x00A0;=&#x00A0;astSpecFrame(&#x00A0;&#x0022;System=Freq,StdOfRest=LSRK&#x0022;&#x00A0;);
<br class="fancyvrb" /><a 
 id="x10-105014r7"></a>&#x00A0;&#x00A0;cmpframe&#x00A0;=&#x00A0;astCmpFrame(&#x00A0;skyframe,&#x00A0;specframe,&#x00A0;&#x0022;&#x0022;&#x00A0;);</div>
<!--l. 5605--><p class="noindent" >In the resulting CmpFrame, axis 1 will be RA, axis 2 will be Dec and axis 3 will be Frequency. If this is
not the order you want, you can permute the axes using <a 
href="sun211ss137.html#x162-3540000">astPermAxes</a>.
<!--l. 5610--><p class="noindent" >There is one potential problem with this approach if you are interested in unusually high accuracy.
Conversion between different standards of rest involves taking account of the Doppler shift caused
by the relative motion of the two standards of rest. At some point this involves finding
the component of the relative velocity in the direction of interest. For a SpecFrame, this
direction is always given by the <a 
href="sun211ss379.html#x405-5970000">RefRA</a> and <a 
href="sun211ss378.html#x404-5960000">RefDec</a> attributes, even if the SpecFrame is
embedded within a CmpFrame as above. It would be more appropriate if this &#x201C;direction of
interest&#x201D; was specified by the values passed into the CmpFrame on the RA and DEC axes,
allowing each pixel within a data cube to have a slightly different correction for Doppler
shift.
<!--l. 5622--><p class="noindent" >Unfortunately, the SpecFrame class cannot do this (since it is purely a 1-dimensional Frame), and so
some small degree of error will be introduced when converting between standards of rest, the size of
the error varying from pixel to pixel. It is hoped that at some point in the future a sub-class of
CmpFrame (a SpecCubeFrame) will be added to AST which allows for this spatial variation in
Doppler shift.
<!--l. 5629--><p class="noindent" >The maximum velocity error introduced by this problem is of the order of
                                                                                       

                                                                                       
<!--l. 5630--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> <mo 
class="MathClass-bin">&#x2217;</mo><mi 
>S</mi><mi 
>I</mi><mi 
>N</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>F</mi><mi 
>O</mi><mi 
>V</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>, where
<!--l. 5630--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>F</mi><mi 
>O</mi><mi 
>V</mi></math> is the angular
field of view, and <!--l. 5630--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi></math>
is the relative velocity of the two standards of rest. As an example, when correcting from the observers
rest frame (i.e. the topocentric rest frame) to the kinematic local standard of rest the maximum value of
<!--l. 5633--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi></math> is about 20
<!--l. 5634--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi><mi 
>m</mi><mo 
class="MathClass-bin">/</mo><mi 
>s</mi></math>, so for
5 arc-minute field of view the maximum velocity error introduced by the correction will be about 0.03
<!--l. 5635--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi><mi 
>m</mi><mo 
class="MathClass-bin">/</mo><mi 
>s</mi></math>. As
another example, the maximum error when correcting from the observers rest frame to the local group is
about 5 <!--l. 5637--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi><mi 
>m</mi><mo 
class="MathClass-bin">/</mo><mi 
>s</mi></math>
over a 1 degree field of view.
<a 
 id="x10-105015r117"></a>
<h4 class="subsectionHead"><span class="titlemark">9.7    </span> <a 
 id="x10-1060007"></a>Handling Dual-Sideband Spectra</h4>
<!--l. 5641--><p class="noindent" >Dual sideband super-heterodyne receivers produce spectra in which each channel contains
contributions from two different frequencies, referred to as the &#x201C;upper sideband frequency&#x201D; and the
&#x201C;lower sideband frequency&#x201D;. In the rest frame of the observer (topocentric), these are related to each
other as follows:
     <div class="quote">
     <!--l. 5648--><p class="noindent" ><div class="small"> <table class="equation"><tr><td> <a 
 id="x10-106001r1"></a>
     <!--l. 5649--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                                                   <msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>l</mi><mi 
>s</mi><mi 
>b</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mi 
>.</mi><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>L</mi><mi 
>O</mi></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>u</mi><mi 
>s</mi><mi 
>b</mi></mrow></msub 
>
</math></td><td class="eq-no">(1)</td></tr></table>
     <!--l. 5653--><p class="noindent" ></div></div>
<!--l. 5656--><p class="noindent" >where <!--l. 5656--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>L</mi><mi 
>O</mi></mrow></msub 
></math>
is a fixed frequency known as the &#x201C;local oscillator frequency&#x201D;. In other words, the local oscillator
frequency is always mid-way between any pair of corresponding upper and lower sideband
frequencies<span class="footnote-mark"><a 
href="#fn17x0" id="fn17x0-bk"><sup class="textsuperscript">17</sup></a></span><a 
 id="x10-106002f17"></a>. If you
want to describe the spectral axis of such a spectrum using a <a 
href="sun211ss481.html#x508-7000000">SpecFrame</a> you must choose whether you want the
SpecFrame to describe <!--l. 5662--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>l</mi><mi 
>s</mi><mi 
>b</mi></mrow></msub 
></math>
or <!--l. 5662--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>u</mi><mi 
>s</mi><mi 
>b</mi></mrow></msub 
></math> - a
basic SpecFrame cannot describe both sidebands simultaneously. However, there is a sub-class of
SpecFrame, called <a 
href="sun211ss446.html#x473-6650000">DSBSpecFrame</a>, which overcomes this difficulty.
                                                                                       

                                                                                       
<!--l. 5666--><p class="noindent" >A DSBSpecFrame has a <a 
href="sun211ss386.html#x412-6040000">SideBand</a> attribute which indicates if the DSBSpecFrame is currently being
used to describe the upper or lower sideband spectral axis. The value of this attribute can be
changed at any time. If you use the <a 
href="sun211ss32.html#x57-2490000">astConvert</a> function to find the <a 
href="sun211ss459.html#x486-6780000">Mapping</a> between two
DSBSpecFrames, the setting for the two SideBand attributes will be taken into account.
Thus, if you take a copy of a DSBSpecFrame, toggle its SideBand attribute, and then use
astConvert to find a Mapping from the original to the modified copy, the resulting Mapping
will be of the form of equation <a 
href="#x10-106001r1">1<!--tex4ht:ref: eqn:dsb --></a> (if the DSBSpecFrame has its <a 
href="sun211ss409.html#x435-6270000">StdOfRest</a> attribute set to
&#x201C;Topocentric&#x201D;).
<!--l. 5679--><p class="noindent" >In general, when finding a Mapping between two arbitrary DSBSpecFrames, the total Mapping is
made of of three parts in series:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  (1) </dt><dd 
class="enumerate-enumitem">A   Mapping   which   converts   the   first   DSBSpecFrame   into   its   upper   sideband
     representation. If the DSBSpecFrame already represents its upper sideband, this Mapping
     will be a <a 
href="sun211ss495.html#x522-7140000">UnitMap</a>.
     </dd><dt class="enumerate-enumitem">
  (2) </dt><dd 
class="enumerate-enumitem">A Mapping which converts from the first to the second DSBSpecFrame, treating them as if
     they were both basic SpecFrames. This takes account of any difference in units, standard
     of rest, system, <em>etc</em> between the two DSBSpecFrames.
     </dd><dt class="enumerate-enumitem">
  (3) </dt><dd 
class="enumerate-enumitem">A   Mapping   which   converts   the   second   DSBSpecFrame   from   its   upper   sideband
     representation to its current sideband. If the DSBSpecFrame currently represents its upper
     sideband, this Mapping will be a UnitMap.</dd></dl>
<!--l. 5695--><p class="noindent" >If an attempt is made to find the Mapping between a DSBSpecFrame and a basic SpecFrame, then the
DSBSpecFrame will be treated like a basic SpecFrame. In other words, the returned Mapping will not
be affected by the setting of the SideBand attribute (or any of the other attributes specific to the
DSBSpecFrame class).
<!--l. 5701--><p class="noindent" >In practice, the local oscillator frequency for a dual sideband instrument may not be easily available to
an observer. Instead, it is common practice to specify the spectral position of some central feature
in the observation (commonly the centre of the instrument passband), together with an
&#x201C;intermediate frequency&#x201D;. Together, these two values allow the local oscillator frequency
to be determined. The intermediate frequency is the difference between the topocentric
frequency at the central spectral position and the topocentric frequency of the local oscillator.
So:
     <div class="quote">
     <!--l. 5712--><p class="noindent" ><div class="small"> <table class="equation"><tr><td> <a 
 id="x10-106006r2"></a>
                                                                                       

                                                                                       
     <!--l. 5713--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                                                   <msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>L</mi><mi 
>O</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>c</mi><mi 
>e</mi><mi 
>n</mi><mi 
>t</mi><mi 
>r</mi><mi 
>a</mi><mi 
>l</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>i</mi><mi 
>f</mi></mrow></msub 
>
</math></td><td class="eq-no">(2)</td></tr></table>
     <!--l. 5717--><p class="noindent" ></div></div>
<!--l. 5720--><p class="noindent" >The DSBSpecFrame class uses the <a 
href="sun211ss274.html#x300-4920000">DSBCentre</a> attribute to specify the central spectral position
(<!--l. 5721--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>c</mi><mi 
>e</mi><mi 
>n</mi><mi 
>t</mi><mi 
>r</mi><mi 
>a</mi><mi 
>l</mi></mrow></msub 
></math>), and the <a 
href="sun211ss306.html#x332-5240000">IF</a> attribute to specify
the intermediate frequency (<!--l. 5722--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>i</mi><mi 
>f</mi></mrow></msub 
></math>).
The DSBCentre value is given and returned in the spectral system described by the DSBSpecFrame
(thus you do not need to calculate the corresponding topocentric frequency yourself - this will be done
automatically by the DSBSpecFrame when you assign a new value to the DSBCentre attribute). The
value assigned to the IF attribute should always be a topocentric frequency in units of Hz, however a
negative value may be given to indicate that the DSBCentre value is in the upper sideband (that is, if
<!--l. 5729--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi><mi 
>F</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mn>0</mn></math> then
<!--l. 5729--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>c</mi><mi 
>e</mi><mi 
>n</mi><mi 
>t</mi><mi 
>r</mi><mi 
>a</mi><mi 
>l</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x003E;</mo> <msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>L</mi><mi 
>O</mi></mrow></msub 
></math>). A
positive value for IF indicates that the DSBCentre value is in the lower sideband (that is, if
<!--l. 5731--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi><mi 
>F</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn></math> then
<!--l. 5731--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>c</mi><mi 
>e</mi><mi 
>n</mi><mi 
>t</mi><mi 
>r</mi><mi 
>a</mi><mi 
>l</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x003C;</mo> <msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>L</mi><mi 
>O</mi></mrow></msub 
></math>).
                                                                                       

                                                                                       
<!--l. 5734--><p class="noindent" >
                                                                                       

                                                                                       
                                                                                       

                                                                                       
<div class="footnotes"><!--l. 5660--><p class="noindent" ><span class="footnote-mark"><a 
href="#fn17x0-bk" id="fn17x0"><sup class="textsuperscript">17</sup></a></span>Note, this simple relationship only applies if all frequencies are topocentric.                           </div> <div class="crosslinks">
<div class="copyright"><span class="pushright">Copyright (C) 2014 Science &#x0026; Technology Facilities Council</span></div> <ul class='nav'> <li class="prev"> <a 
href="sun211se8.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for Handling<BR>World
Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211se10.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li> </ul></div>
<!--l. 5735--><p class="noindent" ><a 
 id="tailsun211se9.html"></a> 
</body> 
</html>