<!DOCTYPE html> 
<html> 
<head><title>Producing Graphical Output (Plots)</title> 
<meta charset=utf-8/> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<link rel="stylesheet" type="text/css" href="sun211.css" /> 
 <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML"></script><style type="text/css">.MathJax_MathML {text-indent: 0;}</style></head><body 
>
<div class="crosslinks"><ul class='nav'> <li class="prev"> <a 
href="sun211se20.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for Handling<BR>World Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211se22.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li>
</ul></div>
<h3 class="sectionHead"><span class="titlemark">21    </span> <a 
 id="x22-19600021"></a>Producing Graphical Output (Plots)</h3>
<div class="sectionTOCS">
&#x00A0;<span class="subsectionToc" >21.1 <a 
href="#x22-1970001">The Plot Model</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.2 <a 
href="#x22-1980002">Plotting Symbols</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.3 <a 
href="#x22-1990003">Plotting Geodesic Curves</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.4 <a 
href="#x22-2000004">Plotting Curves Parallel to Axes</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.5 <a 
href="#x22-2010005">Plotting Generalized Curves</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.6 <a 
href="#x22-2020006">Clipping</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.7 <a 
href="#x22-2030007">Using a Plot as a Mapping</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.8 <a 
href="#x22-2040008">Using a Plot as a Frame</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.9 <a 
href="#x22-2050009">Regions of Valid Physical Coordinates</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.10 <a 
href="#x22-20600010">Plotting Borders</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.11 <a 
href="#x22-20700011">Plotting Text</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.12 <a 
href="#x22-20800012">Plotting a Grid</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.13 <a 
href="#x22-20900013">Controlling the Appearance of Sub-strings</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.14 <a 
href="#x22-21000014">Producing Logarithmic Axes</a></span>
<br />&#x00A0;<span class="subsectionToc" >21.15 <a 
href="#x22-21100015">Choosing a Graphics Package</a></span>
</div>
<!--l. 10304--><p class="noindent" >Graphical output from AST is performed though an <a 
href="sun211ss464.html#x491-6830000">Object</a> called a <a 
href="sun211ss467.html#x494-6860000">Plot</a>, which is a specialised form of
<a 
href="sun211ss453.html#x480-6720000">FrameSet</a>. A Plot does not represent the graphical content itself, but is a route through which plotting
operations, such as drawing lines and curves, are conveyed on to a plotting surface to appear as
visible graphics.
<a 
 id="x22-196001r212"></a>
<h4 class="subsectionHead"><span class="titlemark">21.1    </span> <a 
 id="x22-1970001"></a>The Plot Model</h4>
<!--l. 10312--><p class="noindent" >When a <a 
href="sun211ss467.html#x494-6860000">Plot</a> is created, it is initialised by providing a <a 
href="sun211ss453.html#x480-6720000">FrameSet</a> whose base <a 
href="sun211ss452.html#x479-6710000">Frame</a> (as specified by its
                                                                                       

                                                                                       
<a 
href="sun211ss252.html#x278-4700000">Base</a> attribute) is mapped linearly or logarithmically (as specified by the LogPlot attribues) on to a
<em>plotting area</em>. This is a rectangular region in the graphical coordinate space of the underlying graphics
system and becomes the new base Frame of the Plot. In effect, the Plot becomes attached to the
plotting surface, in rather the same way that a basic FrameSet might be attached to (say) an
image.
<!--l. 10321--><p class="noindent" >The current Frame of the Plot (derived from the current Frame of the FrameSet supplied) is used to
represent a <em>physical coordinate system</em>. This is the system in which plotting operations are
performed by your program. Every plotting operation is then transformed through the <a 
href="sun211ss459.html#x486-6780000">Mapping</a>
which inter-relates the Plot&#x2019;s current and base Frames in order to appear on the plotting
surface.
<!--l. 10328--><p class="noindent" >An example may help here. Suppose we start with a FrameSet whose base Frame describes the pixel
coordinates of an image and whose current Frame describes a celestial (equatorial) coordinate system.
Let us assume that these two Frames are inter-related by a Mapping within the FrameSet which
represents a particular sky projection.
<!--l. 10334--><p class="noindent" >When a Plot is created from this FrameSet, we specify how the pixel coordinates (the base Frame)
maps on to the plotting surface. This simply corresponds to telling the Plot where we have previously
plotted the image data. If we now use the Plot to plot a line with latitude zero in our physical
coordinate system, as given by the current Frame, this line would appear as a curve (the equator) on
the plotting surface, correctly registered with the image.
<!--l. 10342--><p class="noindent" >There are a number of plotting functions provided, which all work in a similar way. Plotting operations
are transformed through the Mapping which the Plot represents before they appear on the plotting
surface.<span class="footnote-mark"><a 
href="#fn34x0" id="fn34x0-bk"><sup class="textsuperscript">34</sup></a></span><a 
 id="x22-197001f34"></a>
It is possible to draw symbols, lines, axes, entire grids and more in this way.
<a 
 id="x22-197002r214"></a>
<h4 class="subsectionHead"><span class="titlemark">21.2    </span> <a 
 id="x22-1980002"></a>Plotting Symbols</h4>
<!--l. 10355--><p class="noindent" >The simplest form of plotting is to draw symbols (termed <em>markers</em>) at a set of points. This is performed
by <a 
href="sun211ss120.html#x145-3370000">astMark</a>, which is supplied with a set of physical coordinates at which to place the
markers:
<div class="fancyvrb" id="fancyvrb228"> <a 
 id="x22-198002r1"></a>&#x00A0;&#x00A0;#include&#x00A0;&#x0022;ast.h&#x0022;<br class="fancyvrb" /><a 
 id="x22-198004r2"></a>&#x00A0;&#x00A0;#define&#x00A0;NCOORD&#x00A0;2<br class="fancyvrb" /><a 
 id="x22-198006r3"></a>&#x00A0;&#x00A0;#define&#x00A0;NMARK&#x00A0;10<br class="fancyvrb" /><a 
 id="x22-198008r4"></a>&#x00A0;&#x00A0;double&#x00A0;in[&#x00A0;NCOORD&#x00A0;][&#x00A0;NMARK&#x00A0;];
<br class="fancyvrb" /><a 
 id="x22-198010r5"></a>&#x00A0;&#x00A0;int&#x00A0;type;<br class="fancyvrb" /><a 
 id="x22-198012r6"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-198014r7"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x22-198016r8"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-198018r9"></a>&#x00A0;&#x00A0;astMark(&#x00A0;plot,&#x00A0;NMARK,&#x00A0;NCOORD,&#x00A0;NMARK,&#x00A0;in,&#x00A0;type&#x00A0;);</div>
<!--l. 10374--><p class="noindent" >Here, NMARK specifies how many markers to plot and NCOORD specifies how many coordinates are being supplied
for each point.<span class="footnote-mark"><a 
href="#fn35x0" id="fn35x0-bk"><sup class="textsuperscript">35</sup></a></span><a 
 id="x22-198019f35"></a>
The array &#x201C;in&#x201D; supplies the coordinates and the integer &#x201C;type&#x201D; specifies which type of marker to
plot.
<a 
 id="x22-198020r215"></a>
<h4 class="subsectionHead"><span class="titlemark">21.3    </span> <a 
 id="x22-1990003"></a>Plotting Geodesic Curves</h4>
<!--l. 10383--><p class="noindent" >There is no <a 
href="sun211ss467.html#x494-6860000">Plot</a> routine to draw a straight line, because any straight line in physical coordinates can
potentially turn into a curve in graphical coordinates. We therefore start by considering how to draw
geodesic curves. These are curves which trace the path of shortest distance between two points in
physical coordinates and are the basic drawing element in a Plot.
                                                                                       

                                                                                       
<!--l. 10390--><p class="noindent" >In many instances, the geodesic will, in fact, be a straight line, but this depends on the Plot&#x2019;s
current <a 
href="sun211ss452.html#x479-6710000">Frame</a>. If this represents a celestial coordinate system, for instance, it will be a great
circle (corresponding with the behaviour of the <a 
href="sun211ss41.html#x66-2580000">astDistance</a> function which defines the
metric of the physical coordinate space). The geodesic will, of course, be transformed into
graphics coordinates before being plotted. A geodesic curve is plotted using <a 
href="sun211ss36.html#x61-2530000">astCurve</a> as
follows:
<div class="fancyvrb" id="fancyvrb229"> <a 
 id="x22-199002r1"></a>&#x00A0;&#x00A0;double&#x00A0;start[&#x00A0;NCOORD&#x00A0;],&#x00A0;finish[&#x00A0;NCOORD&#x00A0;];<br class="fancyvrb" /><a 
 id="x22-199004r2"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-199006r3"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x22-199008r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-199010r5"></a>&#x00A0;&#x00A0;astCurve(&#x00A0;plot,&#x00A0;start,&#x00A0;finish&#x00A0;);</div>
<!--l. 10408--><p class="noindent" >Here, &#x201C;start&#x201D; and &#x201C;finish&#x201D; are arrays containing the starting and finishing coordinates of the
curve. The <a 
href="sun211ss131.html#x156-3480000">astOffset</a> and astDistance functions can often be useful for computing these
(&#x00A7;<a 
href="sun211se7.html#x8-8400011">7.11<!--tex4ht:ref: ss:distanceandoffset --></a>).
<!--l. 10413--><p class="noindent" >If you need to draw a series of curves end-to-end (when drawing a contour line, for example), then a
more efficient alternative is to use <a 
href="sun211ss143.html#x168-3600000">astPolyCurve</a>. This has the same effect as a sequence of invocations
of astCurve, but allows you to supply a whole set of points at one time. astPolyCurve then joins them,
in sequence, using geodesic curves:
<div class="fancyvrb" id="fancyvrb230"> <a 
 id="x22-199012r1"></a>&#x00A0;&#x00A0;#define&#x00A0;NPOINT&#x00A0;100<br class="fancyvrb" /><a 
 id="x22-199014r2"></a>&#x00A0;&#x00A0;double&#x00A0;coords[&#x00A0;NCOORD&#x00A0;][&#x00A0;NPOINT&#x00A0;];<br class="fancyvrb" /><a 
 id="x22-199016r3"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-199018r4"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x22-199020r5"></a>&#x00A0;&#x00A0;
<br class="fancyvrb" /><a 
 id="x22-199022r6"></a>&#x00A0;&#x00A0;astPolyCurve(&#x00A0;plot,&#x00A0;NPOINT,&#x00A0;NCOORD,&#x00A0;NPOINT,&#x00A0;coords&#x00A0;);</div>
<!--l. 10431--><p class="noindent" >Here, NPOINT specifies how many points are to be joined and NCOORD specifies how many
coordinates are being supplied for each point. The array &#x201C;coords&#x201D; supplies the coordinates of the
points in the Plot&#x2019;s physical coordinate system.
<a 
 id="x22-199023r216"></a>
<h4 class="subsectionHead"><span class="titlemark">21.4    </span> <a 
 id="x22-2000004"></a>Plotting Curves Parallel to Axes</h4>
<!--l. 10438--><p class="noindent" >As there is no <a 
href="sun211ss467.html#x494-6860000">Plot</a> function to draw a &#x201C;straight line&#x201D;, drawing axes and grid lines to represent
coordinate systems requires a slightly different approach. The problem is that for some coordinate
systems, these grid lines will not be geodesics, so <a 
href="sun211ss36.html#x61-2530000">astCurve</a> and <a 
href="sun211ss143.html#x168-3600000">astPolyCurve</a> (&#x00A7;<a 
href="#x22-1990003">21.3<!--tex4ht:ref: ss:plottinggeodesics --></a>) cannot easily be
used (you would have to resort to approximating grid lines by many small elements). Lines of
constant celestial latitude provide an example of this, with the exception of the equator which is a
geodesic.
<!--l. 10447--><p class="noindent" >The <a 
href="sun211ss84.html#x109-3010000">astGridLine</a> function allows these curves to be drawn, as follows:
<div class="fancyvrb" id="fancyvrb231"> <a 
 id="x22-200002r1"></a>&#x00A0;&#x00A0;int&#x00A0;axis;<br class="fancyvrb" /><a 
 id="x22-200004r2"></a>&#x00A0;&#x00A0;double&#x00A0;length;<br class="fancyvrb" /><a 
 id="x22-200006r3"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-200008r4"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x22-200010r5"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-200012r6"></a>&#x00A0;&#x00A0;astGridLine(&#x00A0;plot,&#x00A0;axis,&#x00A0;start,&#x00A0;length&#x00A0;);</div>
<!--l. 10460--><p class="noindent" >Here, &#x201C;axis&#x201D; specifies which physical coordinate axis we wish to draw parallel to. The &#x201C;start&#x201D; array
contains the coordinates of the start of the curve and &#x201C;length&#x201D; specifies the distance to draw along the
axis in physical coordinate space.
<a 
 id="x22-200013r217"></a>
                                                                                       

                                                                                       
<h4 class="subsectionHead"><span class="titlemark">21.5    </span> <a 
 id="x22-2010005"></a>Plotting Generalized Curves</h4>
<!--l. 10466--><p class="noindent" >We have seen how geodesic curves and grid lines can be drawn. The <a 
href="sun211ss467.html#x494-6860000">Plot</a> class includes another method,
<a 
href="sun211ss60.html#x85-2770000">astGenCurve</a>, which allows curves of <em>any</em> form to be drawn. The caller supplies a <a 
href="sun211ss459.html#x486-6780000">Mapping</a> which maps offset
along the curve<span class="footnote-mark"><a 
href="#fn36x0" id="fn36x0-bk"><sup class="textsuperscript">36</sup></a></span><a 
 id="x22-201001f36"></a>
into the corresponding position in the current <a 
href="sun211ss452.html#x479-6710000">Frame</a> of the Plot. astGenCurve, then takes care of
Mapping these positions into graphics coordinates. The choice of exactly which positions along the
curve are to be used to define the curve is also made by astGenCurve, using an adaptive algorithm
which concentrates points around areas where the curve is bending sharply or is discontinuous in
graphics coordinates.
<!--l. 10482--><p class="noindent" >The <a 
href="sun211ss456.html#x483-6750000">IntraMap</a> class may be of particular use in this context since it allows you to code your own
Mappings to do any transformation you choose.
<a 
 id="x22-201002r218"></a>
<h4 class="subsectionHead"><span class="titlemark">21.6    </span> <a 
 id="x22-2020006"></a>Clipping</h4>
<!--l. 10488--><p class="noindent" >Like many graphics systems, a <a 
href="sun211ss467.html#x494-6860000">Plot</a> allows you to <em>clip</em> the graphics you produce. This means that
plotting is restricted to certain regions of the plotting surface so that anything drawn outside these
regions will not appear. All Plots automatically clip at the edges of the plotting area specified when
the Plot is created. This means that graphics are ultimately restricted to the rectangular region of
plotting space to which you have attached the Plot.
<!--l. 10496--><p class="noindent" >In addition to this, you may also specify lower and upper limits on each axis at which clipping should
occur. This permits you to further restrict the plotting region. Moreover, you may attach
these clipping limits to <em>any</em> of the Frames in the Plot. This allows you to place restrictions
on where plotting will take place in either the physical coordinate system, the graphical
coordinate system, or in any other coordinate system which is described by a <a 
href="sun211ss452.html#x479-6710000">Frame</a> within the
Plot.
<!--l. 10504--><p class="noindent" >For example, you could plot using equatorial coordinates and set up clipping limits in galactic
coordinates. In general, you could set up arbitrary clipping regions by adding a new Frame to a Plot
(in which clipping will be performed) and inter-relating this to the other Frames in a suitable
way.
<!--l. 10510--><p class="noindent" >Clipping limits are defined using the <a 
href="sun211ss23.html#x48-2400000">astClip</a> function, as follows:
<div class="fancyvrb" id="fancyvrb232"> <a 
 id="x22-202002r1"></a>&#x00A0;&#x00A0;#define&#x00A0;NAXES&#x00A0;2<br class="fancyvrb" /><a 
 id="x22-202004r2"></a>&#x00A0;&#x00A0;int&#x00A0;iframe;<br class="fancyvrb" /><a 
 id="x22-202006r3"></a>&#x00A0;&#x00A0;double&#x00A0;lbnd[&#x00A0;NAXES&#x00A0;],&#x00A0;ubnd[&#x00A0;NAXES&#x00A0;];<br class="fancyvrb" /><a 
 id="x22-202008r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-202010r5"></a>&#x00A0;&#x00A0;...
<br class="fancyvrb" /><a 
 id="x22-202012r6"></a>&#x00A0;&#x00A0;astClip(&#x00A0;plot,&#x00A0;iframe,&#x00A0;lbnd,&#x00A0;ubnd);</div>
<!--l. 10523--><p class="noindent" >Here, the &#x201C;iframe&#x201D; value gives the index of the Frame within the Plot to which clipping is to be
applied, while &#x201C;lbnd&#x201D; and &#x201C;ubnd&#x201D; give the limits on each axis of the selected Frame (NAXES is the
number of axes in this Frame).
<!--l. 10528--><p class="noindent" >You can remove clipping by giving a value of AST__NOFRAME for &#x201C;iframe&#x201D;.
<a 
 id="x22-202013r219"></a>
<h4 class="subsectionHead"><span class="titlemark">21.7    </span> <a 
 id="x22-2030007"></a>Using a Plot as a Mapping</h4>
<!--l. 10532--><p class="noindent" >All Plots are also Mappings (just like the FrameSets from which they are derived), so can be used to
transform coordinates.
                                                                                       

                                                                                       
<!--l. 10535--><p class="noindent" >Like FrameSets, the forward transformation of a <a 
href="sun211ss467.html#x494-6860000">Plot</a> will convert coordinates between the base and
current Frames (<em>i.e.</em>&#x00A0;between graphical and physical coordinates). This would be useful if you were
(say) reading a cursor position in graphical coordinates and needed to convert this into physical
coordinates for display.
<!--l. 10541--><p class="noindent" >Conversely, a Plot&#x2019;s inverse transformation converts between its current and base Frames (<em>i.e.</em>&#x00A0;from
physical coordinates to graphical coordinates). This transformation is applied automatically whenever
plotting operations are carried out by AST functions. It may also be useful to apply it directly,
however, if you wish to perform additional plotting operations (<em>e.g.</em>&#x00A0;those provided by the native
graphics system) at positions specified in physical coordinates.
<!--l. 10550--><p class="noindent" >There is, however, one important difference between using a <a 
href="sun211ss453.html#x480-6720000">FrameSet</a> and a Plot to transform
coordinates, and this is that clipping may be applied by a Plot (if it has been enabled using
<a 
href="sun211ss23.html#x48-2400000">astClip</a>&#x2014;&#x00A7;<a 
href="#x22-2020006">21.6<!--tex4ht:ref: ss:clipping --></a>). Any point which lies within the clipped region of a Plot will, when transformed, yield
coordinates with the value AST__BAD. If you wish to avoid this clipping, you should extract the
relevant <a 
href="sun211ss459.html#x486-6780000">Mapping</a> from the Plot (using <a 
href="sun211ss67.html#x92-2840000">astGetMapping</a>) and use this, instead of the Plot, to transform
the coordinates.
<a 
 id="x22-203001r220"></a>
<h4 class="subsectionHead"><span class="titlemark">21.8    </span> <a 
 id="x22-2040008"></a>Using a Plot as a Frame</h4>
<!--l. 10562--><p class="noindent" >Every <a 
href="sun211ss467.html#x494-6860000">Plot</a> is also a <a 
href="sun211ss452.html#x479-6710000">Frame</a>, so can be used to obtain the values of Frame attributes such as a <a 
href="sun211ss420.html#x446-6380000">Title</a>, axis
Labels, axis Units, <em>etc.</em>, which are typically used when displaying data and/or coordinates. These
attributes are, as for any <a 
href="sun211ss453.html#x480-6720000">FrameSet</a>, derived from the current Frame of the Plot (&#x00A7;<a 
href="sun211se13.html#x14-1300008">13.8<!--tex4ht:ref: ss:framesetasframe --></a>). They are also
used automatically when using the Plot to plot coordinate axes and coordinate grids (<em>e.g.</em>&#x00A0;for labelling
them&#x2014;&#x00A7;<a 
href="#x22-20800012">21.12<!--tex4ht:ref: ss:plottingagrid --></a>).
<!--l. 10571--><p class="noindent" >Because the current Frame of a Plot represents physical coordinates, any Frame operation applied to
the Plot will effectively be working in this coordinate system. For example, the <a 
href="sun211ss41.html#x66-2580000">astDistance</a>
and <a 
href="sun211ss131.html#x156-3480000">astOffset</a> functions will compute distances and offsets in physical coordinate space,
while <a 
href="sun211ss56.html#x81-2730000">astFormat</a> and <a 
href="sun211ss127.html#x152-3440000">astNorm</a> will format physical coordinates in an appropriate way for
display.
<a 
 id="x22-204001r221"></a>
<h4 class="subsectionHead"><span class="titlemark">21.9    </span> <a 
 id="x22-2050009"></a>Regions of Valid Physical Coordinates</h4>
<!--l. 10580--><p class="noindent" >When points in physical coordinate space are transformed by a <a 
href="sun211ss467.html#x494-6860000">Plot</a> into graphics coordinates for
plotting, they may not always yield valid coordinates, irrespective of any clipping being applied
(&#x00A7;<a 
href="#x22-2020006">21.6<!--tex4ht:ref: ss:clipping --></a>). To indicate this, the resulting coordinate values will be set to the value AST__BAD
(&#x00A7;<a 
href="sun211se5.html#x6-620009">5.9<!--tex4ht:ref: ss:badcoordinates --></a>).
<!--l. 10587--><p class="noindent" >There are a number of reasons why this may occur, but typically it will be because physical
coordinates only map on to a subset of the graphics coordinate space. This situation is
commonly encountered with all-sky projections where, typically, the celestial sphere appears,
when plotted, as a distorted shape (<em>e.g.</em>&#x00A0;an ellipse) which does not entirely fill the graphics
space. In some cases, there may even be multiple regions of valid and invalid physical
coordinates.
<!--l. 10595--><p class="noindent" >When plotting is performed <em>via</em> a Plot, graphical output will only appear in the regions of valid
physical coordinates. Nothing will appear where invalid coordinates occur. Such output is effectively
clipped. If you wish to plot in these areas, you must change coordinate system and use, say, graphical
coordinates to address the plotting surface directly.
                                                                                       

                                                                                       
<a 
 id="x22-205001r222"></a>
<h4 class="subsectionHead"><span class="titlemark">21.10    </span> <a 
 id="x22-20600010"></a>Plotting Borders</h4>
<!--l. 10604--><p class="noindent" >The <a 
href="sun211ss14.html#x39-2310000">astBorder</a> function is provided to draw a (line) border around your graphical output. With most
graphics systems, this would simply be a rectangular box around the plotting area. With a <a 
href="sun211ss467.html#x494-6860000">Plot</a>,
however, this boundary follows the edge of each region containing valid, unclipped physical
coordinates (&#x00A7;<a 
href="#x22-2050009">21.9<!--tex4ht:ref: ss:validphysicalcoordinates --></a>).
<!--l. 10610--><p class="noindent" >This means, for example, that if you were plotting an all-sky projection, this boundary would outline
the perimeter of the celestial sphere when projected on to your plotting surface. Of course, if there is
no clipping and all physical coordinates are valid, then you will get the traditional rectangular box.
astBorder requires only a pointer to the Plot:
<div class="fancyvrb" id="fancyvrb233"> <a 
 id="x22-206002r1"></a>&#x00A0;&#x00A0;int&#x00A0;holes;<br class="fancyvrb" /><a 
 id="x22-206004r2"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-206006r3"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x22-206008r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-206010r5"></a>&#x00A0;&#x00A0;holes&#x00A0;=&#x00A0;astBorder(&#x00A0;plot&#x00A0;);</div>
<!--l. 10627--><p class="noindent" >It returns a boolean (integer) value to indicate if any invalid or clipped physical coordinates were
found within the plotting area. If they were, it will draw around the valid unclipped regions
and return a value of one. Otherwise, it will draw a simple rectangular border and return
zero.
<a 
 id="x22-206011r223"></a>
<h4 class="subsectionHead"><span class="titlemark">21.11    </span> <a 
 id="x22-20700011"></a>Plotting Text</h4>
<!--l. 10635--><p class="noindent" >Using a <a 
href="sun211ss467.html#x494-6860000">Plot</a> to draw text involves supplying a string of text to be displayed and a position in physical
coordinates where the text is to appear. The position is transformed into graphical coordinates to
determine where the text should appear on the plotting surface. You must also provide a 2-element
&#x201C;up&#x201D; vector which gives the upward direction of the text in graphical coordinates. This allows text to
be drawn at any angle.
<!--l. 10643--><p class="noindent" >Plotting is performed by <a 
href="sun211ss212.html#x237-4290000">astText</a>, for example:
<div class="fancyvrb" id="fancyvrb234"> <a 
 id="x22-207002r1"></a>&#x00A0;&#x00A0;char&#x00A0;text[&#x00A0;21&#x00A0;];<br class="fancyvrb" /><a 
 id="x22-207004r2"></a>&#x00A0;&#x00A0;double&#x00A0;pos[&#x00A0;NCOORD&#x00A0;];<br class="fancyvrb" /><a 
 id="x22-207006r3"></a>&#x00A0;&#x00A0;float&#x00A0;up[&#x00A0;2&#x00A0;]&#x00A0;=&#x00A0;{&#x00A0;0.0f,&#x00A0;1.0f&#x00A0;};<br class="fancyvrb" /><a 
 id="x22-207008r4"></a>&#x00A0;&#x00A0;<br class="fancyvrb" /><a 
 id="x22-207010r5"></a>&#x00A0;&#x00A0;...<br class="fancyvrb" /><a 
 id="x22-207012r6"></a>&#x00A0;&#x00A0;
<br class="fancyvrb" /><a 
 id="x22-207014r7"></a>&#x00A0;&#x00A0;astText(&#x00A0;plot,&#x00A0;text,&#x00A0;pos,&#x00A0;up,&#x00A0;&#x0022;TL&#x0022;&#x00A0;);</div>
<!--l. 10657--><p class="noindent" >Here, &#x201C;text&#x201D; contains the string to be drawn, &#x201C;pos&#x201D; is an array of physical coordinates and &#x201C;up&#x201D;
specifies the upward vector. In this case, the text will be drawn horizontally. The final argument
specifies the text justification, here indicating that the top left corner of the text should appear at the
position given.
<!--l. 10663--><p class="noindent" >Further control over the appearance of the text is possible by setting values for various Plot attributes,
for example Colour, Font and Size. Sub-strings within the displayed text can be given different
appearances, or turned into super-scripts or sub-scripts, by the inclusion of escape sequences (see
section&#x00A0;&#x00A7;<a 
href="#x22-20900013">21.13<!--tex4ht:ref: ss:escapes --></a>) within the supplied text string.
<a 
 id="x22-207015r224"></a>
<h4 class="subsectionHead"><span class="titlemark">21.12    </span> <a 
 id="x22-20800012"></a>Plotting a Grid</h4>
<!--l. 10671--><p class="noindent" >The most comprehensive plotting function available is <a 
href="sun211ss83.html#x108-3000000">astGrid</a>, which can be used to draw labelled
coordinate axes and, optionally, to overlay coordinate grids on the plotting area (Figure&#x00A0;<a 
href="sun211se2.html#x3-140018">8<!--tex4ht:ref: fig:gridplot --></a>). The
routine is straightforward to use, simply requiring a pointer to the <a 
href="sun211ss467.html#x494-6860000">Plot</a>:
                                                                                       

                                                                                       
<div class="fancyvrb" id="fancyvrb235"> <a 
 id="x22-208002r1"></a>&#x00A0;&#x00A0;astGrid(&#x00A0;plot&#x00A0;);</div>
<!--l. 10683--><p class="noindent" >It will draw both linear and curvilinear axes and grids, as required by the particular Plot. The
appearance of the output can be modified in a wide variety of ways by setting various Plot attributes.
The Label attributes of the current <a 
href="sun211ss452.html#x479-6710000">Frame</a> are displayed as the axis labels in the grid, and the <a 
href="sun211ss420.html#x446-6380000">Title</a>
attribute as the plot title. Sub-strings within these strings can be given different appearances, or
turned into super-scripts or sub-scripts, by the inclusion of escape sequences (see section&#x00A0;&#x00A7;<a 
href="#x22-20900013">21.13<!--tex4ht:ref: ss:escapes --></a>)
within the Label attributes.
<a 
 id="x22-208003r225"></a>
<h4 class="subsectionHead"><span class="titlemark">21.13    </span> <a 
 id="x22-20900013"></a>Controlling the Appearance of Sub-strings</h4>
<!--l. 10693--><p class="noindent" >Normally, each string of characters displayed using a <a 
href="sun211ss467.html#x494-6860000">Plot</a> will be plotted so that all characters in the
string have the same font size, colour, <em>etc.</em>, specified by the appropriate attributes of the Plot. However,
it is possible to include <em>escape sequences</em> within the text to modify the appearance of sub-strings. <a 
href="sun211ss287.html#x313-5050000">Escape</a>
sequences can be used to change, colour, font, size, width, to introduce extra horizontal space
between characters, and to change the base line of characters (thus allowing super-scripts
and sub-scripts to be created). See the entry for the Escape attribute in Appendix&#x00A0;<a 
href="sun211se25.html#x266-4580003">C<!--tex4ht:ref: ss:attributedescriptions --></a> for
details.
<!--l. 10703--><p class="noindent" >As an example, if the character string &#x201C;<span class="obeylines-h"><span class="verb">10&#x005C;%^50</span></span>%s70+0.5+&#x201D; is plotted, it will be displayed as
&#x201C;<!--l. 10704--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>0</mn><mi 
>.</mi><mn>5</mn></mrow></msup 
></math>&#x201D; - that
is, with a super-scripted exponent. The exponent text will be 70% of the size of normal text (as
determined by the Size attribute), and its baseline will be raised by 50% of the height of a normal
character.
<!--l. 10709--><p class="noindent" >Such escape sequences can be used in the strings assigned to textual attributes of the Plot (such as the
axis Labels), and may also be included in strings plotted using <a 
href="sun211ss212.html#x237-4290000">astText</a>.
<!--l. 10714--><p class="noindent" >The Format attribute for the <a 
href="sun211ss477.html#x504-6960000">SkyAxis</a> class includes the &#x201C;g&#x201D; option which will cause escape
sequences to be included when formatting celestial positions so that super-script characters are
used as delimiters for the various fields (a super-script &#x201C;h&#x201D; for hours, &#x201C;m&#x201D; for minutes,
<em>etc</em>).
<!--l. 10720--><p class="noindent" >Note, the facility for interpreting escape sequences is only available if the graphics wrapper functions
which provide the interface to the underlying graphics system support all the functions included in
the <span class="obeylines-h"><span class="verb">grf.h</span></span> file as of AST V3.2. Older grf interfaces may need to be extended by the addition of new
functions before escape sequences can be interpretted.
<a 
 id="x22-209001r226"></a>
<h4 class="subsectionHead"><span class="titlemark">21.14    </span> <a 
 id="x22-21000014"></a>Producing Logarithmic Axes</h4>
<!--l. 10728--><p class="noindent" >In certain situations you may wish for one or both of the plotted axes to be displayed logarithmically
rather than linearly. For instance, you may wish to do this when using a <a 
href="sun211ss467.html#x494-6860000">Plot</a> to represent a spectrum
of, say, flux against frequency. In this case, you can cause the frequency axis to be drawn
logarithmically simply by setting the boolean LogPlot attribute for the frequency axis to a non-zero
value. This causes several things to happen:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  (1) </dt><dd 
class="enumerate-enumitem">The  <a 
href="sun211ss459.html#x486-6780000">Mapping</a>  between  the  base  <a 
href="sun211ss452.html#x479-6710000">Frame</a>  of  the  Plot  (which  represents  the  underlying
     graphics world coordinate system) and the base Frame of the <a 
href="sun211ss453.html#x480-6720000">FrameSet</a> supplied when
                                                                                       

                                                                                       
     the Plot was created, is modified. By default, this mapping is linear on both axes, but
     setting  LogPlot  non-zero  for  an  axis  causes  the  Mapping  to  be  modified  so  that  it  is
     logarithmic on the specified axis. This is only possible if the displayed section of the axis
     does not include the value zero (otherwise the attempt to set a new value for LogPlot is
     ignored,and it retains its default value of zero).
     </dd><dt class="enumerate-enumitem">
  (2) </dt><dd 
class="enumerate-enumitem">The  major  tick  marks  drawn  as  part  of  the  annotated  coordinate  grid  are  spaced
     logarithmically rather than linearly. That is, major axis values are chosen so that there
     is a constant ratio between adjacent tick mark values. This ratio is constrained to be a
     power of ten. The minor tick marks are drawn at linearly distributed points between the
     adjoining major tick values. Thus if a pair of adjacent major tick values are drawn at axis
     values 10.0 and 100.0, minor ticks will be placed at 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0
     and 90.0 (note only 8 minor tick marks are drawn).
     </dd><dt class="enumerate-enumitem">
  (3) </dt><dd 
class="enumerate-enumitem">If possible, numerical axis labels are shown as powers of ten. This depends on the facilities
     implemented by the graphics wrapper functions (see the next section). Extra functions
     were introduced to this set of wrapper functions at AST V3.2 which enable super-scripts
     and sub-scripts to be produced. Some older wrappers may not yet have implemented
     these functiosn and this will result in axis labels being drawn in usual scientific or decimal
     notation.
     </dd></dl>
<!--l. 10767--><p class="noindent" >Whilst the LogPlot attribute can be used to control all three of the above facilities, it is possible to
control them individually as well. The LogTicks and LogLabel attributes control the behaviour
specified in items 2 and 3 above, but the default values for these attributes depend on the
setting of the LogPlot attribute. This means that setting LogPlot non-zero will swicth all
three facilites on, so long as zero values have not been assigned explicitly to LogTicks or
LogLabel.
<a 
 id="x22-210004r227"></a>
<h4 class="subsectionHead"><span class="titlemark">21.15    </span> <a 
 id="x22-21100015"></a>Choosing a Graphics Package</h4>
<!--l. 10777--><p class="noindent" >The <a 
href="sun211ss467.html#x494-6860000">Plot</a> class itself does not include any code for actually drawing on a graphics device. Instead, it
requires a set of functions to be provided which it uses to draw the required graphics. These include
functions to draw a straight line, draw a text string, <em>etc</em>. You may choose to provide functions from
your favorite graphics package, or you can even write your own! To accomodate variations in the
calling interfaces of different graphics packages, AST defines a standard interface for these routines. If
this interface differs from the interface provided by your graphics package (which in general it will),
then you must write a set of <em>wrapper functions</em>, which provide the interface expected by
AST but which then call functions from your graphics package to provide the required
functionality. AST comes with wrapper functions suitable for the PGPLOT graphics package (see
<a 
href="http://www.starlink.ac.uk/cgi-bin/htxserver/sun15.htx/sun15.html?xref_" >SUN/15</a>).
<!--l. 10791--><p class="noindent" >There are two ways of indicating which wrapper functions are to be used by the Plot class:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  (1) </dt><dd 
class="enumerate-enumitem">A  file  containing  C  functions  with  pre-defined  names  can  be  written  and  linked  with
     the application using options of the <a 
href="sun211ss501.html#x529-7210000">ast_link</a> command. (see &#x00A7;<a 
href="sun211se3.html#x4-180003">3.3<!--tex4ht:ref: ss:howtobuild --></a> and Appendix&#x00A0;<a 
href="sun211se27.html#x528-7200005">E<!--tex4ht:ref: ss:commanddescriptions --></a>). AST
                                                                                       

                                                                                       
     is distributed with such a file (called <code>grf_pgplot.c</code>) which calls PGPLOT functions to
     implement the required functionality. This file can be used as a template for writing your
     own.
     </dd><dt class="enumerate-enumitem">
  (2) </dt><dd 
class="enumerate-enumitem">The <a 
href="sun211ss82.html#x107-2990000">astGrfSet</a> method of the Plot class can be used to &#x201C;register&#x201D; wrapper functions at
     run-time.  This  allows  an  application  to  switch  between  graphics  systems  if  required.
     Graphics functions registered in this way do not need to have the pre-defined names used
     in the link-time method described above.
     </dd></dl>
<!--l. 10812--><p class="noindent" >For details of the interfaces of the wrapper routines, see either the <code>grf_pgplot.c</code> file included in the
AST source distribution, or the reference documentation for the astGrfSet method.
                                                                                       

                                                                                       
                                                                                       

                                                                                       
<div class="footnotes"><!--l. 10348--><p class="noindent" ><span class="footnote-mark"><a 
href="#fn34x0-bk" id="fn34x0"><sup class="textsuperscript">34</sup></a></span>Like any FrameSet, a Plot can be used as a Mapping. In this case it is the inverse transformation which is used when
plotting (<em>i.e.</em>&#x00A0;that which transforms between the current and base Frames).
<!--l. 10377--><p class="noindent" ><span class="footnote-mark"><a 
href="#fn35x0-bk" id="fn35x0"><sup class="textsuperscript">35</sup></a></span>Remember, the physical coordinate space need not necessarily be 2-dimensional, even if the plotting surface
is.
<!--l. 10472--><p class="noindent" ><span class="footnote-mark"><a 
href="#fn36x0-bk" id="fn36x0"><sup class="textsuperscript">36</sup></a></span>normalized so that the start of the curve is at offset 0.0 and the end of the curve is at offset 1.0 - offset need not be linearly
related to distance.                                                                        </div> <div class="crosslinks">
<div class="copyright"><span class="pushright">Copyright (C) 2014 Science &#x0026; Technology Facilities Council</span></div> <ul class='nav'> <li class="prev"> <a 
href="sun211se20.html" >&#8592Prev</a>&#x00A0;</li> <li class="title">AST<BR>A Library for Handling<BR>World
Coordinate Systems<BR>in Astronomy</li> <li class="next"><a 
href="sun211se22.html" >Next&#8594</a>&#x00A0;</li> <li class="toc"><a 
href="sun211.html#toc">TOC &#8593</a></li> </ul></div>
<!--l. 10817--><p class="noindent" ><a 
 id="tailsun211se21.html"></a> 
</body> 
</html>